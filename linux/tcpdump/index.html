<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=wuseman><link href=https://www.nr1.nu/linux/tcpdump/ rel=canonical><link rel="shortcut icon" href=../../img/favicon.ico><title>tcpdump - Nr1 (wuseman's wiki)</title><link href=../../css/bootstrap-3.3.7.min.css rel=stylesheet><link href=../../css/font-awesome.min.css rel=stylesheet><link href=../../css/base.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css><link href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css rel=stylesheet><link href=../../assets/pymdownx-extras/extra-e384f43f0f.css rel=stylesheet><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script src=../../js/jquery-1.10.2.min.js defer></script><script src=../../js/bootstrap-3.3.7.min.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script></head> <body> <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary"> <div class=container> <a class=navbar-brand href=../..>Nr1 (wuseman's wiki)</a> <!-- Expander button --> <button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse> <span class=navbar-toggler-icon></span> </button> <!-- Expanded navigation --> <div id=navbar-collapse class="navbar-collapse collapse"> <!-- Main navigation --> <ul class="nav navbar-nav"> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Home <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../.. class=dropdown-item>About</a> </li> <li> <a href=../../contact/ class=dropdown-item>Contact</a> </li> <li> <a href=../../cv/ class=dropdown-item>CV</a> </li> <li> <a href=../../usage_notes/ class=dropdown-item>Help</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Android <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../android/ class=dropdown-item>info</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>adb</a> <ul class=dropdown-menu> <li> <a href=../../android/adb/readme/ class=dropdown-item>adb</a> </li> <li> <a href=../../android/adb/at/ class=dropdown-item>at-commands</a> </li> <li> <a href=../../android/adb/uusd_codes/ class=dropdown-item>uusd-codes</a> </li> </ul> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Cracking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../cracking/ class=dropdown-item>info</a> </li> <li> <a href=../../cracking/wloader/ class=dropdown-item>wloader</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Gentoo <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../gentoo/gentoo-tools/ class=dropdown-item>gentoo-cheatsheet</a> </li> <li> <a href=../../gentoo/gentoo-chroot/ class=dropdown-item>gentoo-chroot</a> </li> <li> <a href=../../gentoo/gentoo-vmware/ class=dropdown-item>gentoo-vmware</a> </li> <li> <a href=../../gentoo/wuseman-overlay/ class=dropdown-item>wuseman-overlay</a> </li> <li> <a href=../../gentoo/gentoo-update/ class=dropdown-item>gentoo-wupdate</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Hacking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../hacking/ class=dropdown-item>hacking</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bios</a> <ul class=dropdown-menu> <li> <a href=../../hacking/bios/ class=dropdown-item>bios</a> </li> <li> <a href=../../hacking/bios/hp_device_and_bios-hacking/ class=dropdown-item>hp bios</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bruteforce</a> <ul class=dropdown-menu> <li> <a href=../../hacking/bruteforce/ class=dropdown-item>bruteforce</a> </li> <li> <a href=../../hacking/bruteforce/EMAGNET/ class=dropdown-item>emagnet</a> </li> <li> <a href=../../hacking/bruteforce/wbruter/ class=dropdown-item>wbruter</a> </li> <li> <a href=../../hacking/bruteforce/wssh/ class=dropdown-item>wssh</a> </li> <li> <a href=../../hacking/bruteforce/swedish_wordlist.txt/ class=dropdown-item>swedish wordlist</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Cameras</a> <ul class=dropdown-menu> <li> <a href=../../hacking/cameras/ class=dropdown-item>cameras</a> </li> <li> <a href=../../hacking/cameras/biltemas_babycam/ class=dropdown-item>biltemas babycam</a> </li> <li> <a href=../../hacking/cameras/dlink-6100lh/ class=dropdown-item>dlink-6100lh</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Chromebook</a> <ul class=dropdown-menu> <li> <a href=../../hacking/chromebook/ class=dropdown-item>chromebook</a> </li> <li> <a href=../../hacking/chromebook/acer_chromebook_c720/ class=dropdown-item>acer c720</a> </li> <li> <a href=../../hacking/chromebook/acer_chromebook_c740/ class=dropdown-item>acer c740</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Radio</a> <ul class=dropdown-menu> <li> <a href=../../hacking/radio/ class=dropdown-item>radio</a> </li> <li> <a href=../../hacking/radio/boose_soundtouch/ class=dropdown-item>boose soundtouch</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Router</a> <ul class=dropdown-menu> <li> <a href=../../hacking/routers/ class=dropdown-item>router</a> </li> <li> <a href=../../hacking/routers/technicolor_dga4330ts/ class=dropdown-item>technicolor dga4330ts</a> </li> </ul> </li> </ul> </li> <li class="dropdown active"> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Linux <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../apt/ class=dropdown-item>apt</a> </li> <li> <a href=../awk/ class=dropdown-item>awk</a> </li> <li> <a href=../chroot/ class=dropdown-item>chroot</a> </li> <li> <a href=../cryptsetup/ class=dropdown-item>cryptsetup</a> </li> <li> <a href=../curl/ class=dropdown-item>curl</a> </li> <li> <a href=../dev_and_proc/ class=dropdown-item>dev and proc</a> </li> <li> <a href=../exiftool/ class=dropdown-item>exiftool</a> </li> <li> <a href=../find/ class=dropdown-item>find</a> </li> <li> <a href=../git/ class=dropdown-item>git</a> </li> <li> <a href=../gnupg/ class=dropdown-item>gnupg</a> </li> <li> <a href=../grep/ class=dropdown-item>grep</a> </li> <li> <a href=../kernel/ class=dropdown-item>kernel</a> </li> <li> <a href=../log/ class=dropdown-item>log</a> </li> <li> <a href=../matomo/ class=dropdown-item>matomo</a> </li> <li> <a href=../merge-tricks/ class=dropdown-item>merge tricks</a> </li> <li> <a href=../nmap/ class=dropdown-item>nmap</a> </li> <li> <a href=../netstat/ class=dropdown-item>netstat</a> </li> <li> <a href=../perf/ class=dropdown-item>perf</a> </li> <li> <a href=../rename/ class=dropdown-item>rename</a> </li> <li> <a href=../rg/ class=dropdown-item>ripgrep</a> </li> <li> <a href=../sed/ class=dropdown-item>sed</a> </li> <li> <a href=../ssh-log/ class=dropdown-item>ssh-log</a> </li> <li> <a href=../syslog-ng/syslog-conf.ng/ class=dropdown-item>syslog-ng</a> </li> <li> <a href=../sys/ class=dropdown-item>sys</a> </li> <li> <a href=../sqlmap/ class=dropdown-item>sqlmap</a> </li> <li> <a href=./ class="dropdown-item active">tcpdump</a> </li> <li> <a href=../whatismyip/ class=dropdown-item>whatismyip</a> </li> <li> <a href=../wireguard/ class=dropdown-item>wireguard</a> </li> <li> <a href=../vim/ class=dropdown-item>vim</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Misc <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../archive/useragents/user_agents.txt class=dropdown-item>UserAgents</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav ml-auto"> <li class=nav-item> <a href=# class=nav-link data-toggle=modal data-target=#mkdocs_search_modal> <i class="fa fa-search"></i> Search </a> </li> <li class=nav-item> <a rel=prev href=../sqlmap/ class=nav-link> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li class=nav-item> <a rel=next href=../whatismyip/ class=nav-link> Next <i class="fa fa-arrow-right"></i> </a> </li> <li class=nav-item> <a href=https://github.com/www.nr1.nu/tree/master/docs/src/markdown/linux/tcpdump.md class=nav-link>Edit on www.nr1.nu</a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role=complementary> <div class=navbar-header> <button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#toc-collapse title="Table of Contents"> <span class="fa fa-angle-down"></span> </button> </div> <div id=toc-collapse class="navbar-collapse collapse card bg-secondary"> <ul class="nav flex-column"> <li class=nav-item data-level=1><a href=#tcpdump class=nav-link>tcpdump</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#basic-usage class=nav-link>BASIC USAGE</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#getting-creative class=nav-link>Getting Creative</a> <ul class="nav flex-column"> <li class=nav-item data-level=2><a href=#there-are-three-ways-to-do-combination class=nav-link>There are three ways to do combination:</a> <ul class="nav flex-column"> </ul> </li> </ul> </li> <li class=nav-item data-level=1><a href=#usage-example class=nav-link>Usage Example:</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#advanced class=nav-link>Advanced</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#its-all-about-the-combinations class=nav-link>It’s All About the Combinations</a> <ul class="nav flex-column"> <li class=nav-item data-level=2><a href=#here-are-some-examples-of-combined-commands class=nav-link>Here are some examples of combined commands.</a> <ul class="nav flex-column"> </ul> </li> </ul> </li> <li class=nav-item data-level=1><a href=#commands-that-i-using-almost-daily class=nav-link>Commands that I using almost daily</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#usage-example_1 class=nav-link>USAGE EXAMPLE</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#references--awesome-wikis class=nav-link>References &amp; Awesome wikis</a> <ul class="nav flex-column"> </ul> </li> </ul> </div> </div></div> <div class=col-md-9 role=main> <h1 id=tcpdump>tcpdump<a class=headerlink href=#tcpdump title="Permanent link"></a></h1> <p><a href=https://wuseman.github.io/TCPDUMP/ >TCPDUMP</a></p> <p>Tcpdump is one of the best network analysis-tools ever for information security professionals. Tcpdump is for everyone for hackers and people who have less of TCP/IP understanding. </p> <p>Many prefer to use higher-level analysis tools such Wireshark, <em>but I believe it is a mistake</em>. </p> <h4 id=below-are-some-tcpdump-options-with-useful-examples-that-will-help-you-working-with-the-tool-theyre-very-easy-to-forget-andor-confuse-with-other-types-of-filters-ie-ethereal-so-hopefully-this-article-can-serve-as-a-reference-for-you-as-it-does-me>Below are some tcpdump options (with useful examples) that will help you working with the tool. They’re very easy to forget and/or confuse with other types of filters, i.e. ethereal, so hopefully this article can serve as a reference for you, as it does me:)<a class=headerlink href=#below-are-some-tcpdump-options-with-useful-examples-that-will-help-you-working-with-the-tool-theyre-very-easy-to-forget-andor-confuse-with-other-types-of-filters-ie-ethereal-so-hopefully-this-article-can-serve-as-a-reference-for-you-as-it-does-me title="Permanent link"></a></h4> <ul> <li>The first of these is -n, which requests that names are not resolved, resulting in the IPs themselves.</li> <li>The second is -X, which displays both hex and ascii content within the packet.</li> <li>The final one is -S, which changes the display of sequence numbers to absolute rather than relative.</li> </ul> <h3 id=show-the-packets-contents-in-both-hex-and-ascii>Show the packet’s contents in both hex and ascii.<a class=headerlink href=#show-the-packets-contents-in-both-hex-and-ascii title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -X ....
</code></pre></div> <h3 id=same-as--x-but-also-shows-the-ethernet-header>Same as -X, but also shows the ethernet header.<a class=headerlink href=#same-as--x-but-also-shows-the-ethernet-header title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -XX
</code></pre></div> <h3 id=show-the-list-of-available-interfaces>Show the list of available interfaces<a class=headerlink href=#show-the-list-of-available-interfaces title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -D
</code></pre></div> <h3 id=line-readable-output-for-viewing-as-you-save-or-sending-to-other-commands>Line-readable output (for viewing as you save, or sending to other commands)<a class=headerlink href=#line-readable-output-for-viewing-as-you-save-or-sending-to-other-commands title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -l
</code></pre></div> <h3 id=be-less-verbose-more-quiet-with-your-output>Be less verbose (more quiet) with your output.<a class=headerlink href=#be-less-verbose-more-quiet-with-your-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -q
</code></pre></div> <h3 id=give-human-readable-timestamp-output>Give human-readable timestamp output.<a class=headerlink href=#give-human-readable-timestamp-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -t :
</code></pre></div> <h3 id=give-maximally-human-readable-timestamp-output>Give maximally human-readable timestamp output.<a class=headerlink href=#give-maximally-human-readable-timestamp-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -tttt :
</code></pre></div> <h3 id=listen-on-the-eth0-interface>Listen on the eth0 interface.<a class=headerlink href=#listen-on-the-eth0-interface title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0
</code></pre></div> <h3 id=verbose-output-more-vs-gives-more-output>Verbose output (more v’s gives more output).<a class=headerlink href=#verbose-output-more-vs-gives-more-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vv
</code></pre></div> <h3 id=only-get-x-number-of-packets-and-then-stop>Only get x number of packets and then stop.<a class=headerlink href=#only-get-x-number-of-packets-and-then-stop title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -c
</code></pre></div> <h3 id=define-the-snaplength-size-of-the-capture-in-bytes-use--s0-to-get-everything-unless-you-are-intentionally-capturing-less>Define the snaplength (size) of the capture in bytes. Use -s0 to get everything, unless you are intentionally capturing less.<a class=headerlink href=#define-the-snaplength-size-of-the-capture-in-bytes-use--s0-to-get-everything-unless-you-are-intentionally-capturing-less title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -s
</code></pre></div> <h3 id=print-absolute-sequence-numbers>Print absolute sequence numbers.<a class=headerlink href=#print-absolute-sequence-numbers title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -S
</code></pre></div> <h3 id=get-the-ethernet-header-as-well>Get the ethernet header as well.<a class=headerlink href=#get-the-ethernet-header-as-well title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -e
</code></pre></div> <h3 id=decrypt-ipsec-traffic-by-providing-an-encryption-key>Decrypt IPSEC traffic by providing an encryption key.<a class=headerlink href=#decrypt-ipsec-traffic-by-providing-an-encryption-key title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -E
</code></pre></div> <h3 id=for-more-options-read-manual>For more options, read manual:<a class=headerlink href=#for-more-options-read-manual title="Permanent link"></a></h3> <ul> <li>Find all options <a href=https://www.cyberciti.biz/howto/question/man/tcpdump-man-page-with-examples.php>here</a></li> </ul> <h1 id=basic-usage>BASIC USAGE<a class=headerlink href=#basic-usage title="Permanent link"></a></h1> <h3 id=display-available-interfaces>Display Available Interfaces<a class=headerlink href=#display-available-interfaces title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -D
tcpdump --list-interfaces
</code></pre></div> <h3 id=lets-start-with-a-basic-command-that-will-get-us-https-traffic>Let’s start with a basic command that will get us HTTPS traffic:<a class=headerlink href=#lets-start-with-a-basic-command-that-will-get-us-https-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nnSX port 443
</code></pre></div> <h3 id=find-traffic-by-ip>Find Traffic by IP<a class=headerlink href=#find-traffic-by-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump host 1.1.1.1
</code></pre></div> <h3 id=filtering-by-source-andor-destination>Filtering by Source and/or Destination<a class=headerlink href=#filtering-by-source-andor-destination title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump src 1.1.1.1 
tcpdump dst 1.0.0.1
</code></pre></div> <h3 id=finding-packets-by-network>Finding Packets by Network<a class=headerlink href=#finding-packets-by-network title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump net 1.2.3.0/24
</code></pre></div> <h4 id=low-output>Low Output:<a class=headerlink href=#low-output title="Permanent link"></a></h4> <div class=highlight><pre><span></span><code>tcpdump -nnvvS
</code></pre></div> <h4 id=medium-output>Medium Output:<a class=headerlink href=#medium-output title="Permanent link"></a></h4> <div class=highlight><pre><span></span><code>tcpdump -nnvvXS
</code></pre></div> <h4 id=heavy-output>Heavy Output:<a class=headerlink href=#heavy-output title="Permanent link"></a></h4> <div class=highlight><pre><span></span><code>tcpdump -nnvvXSs 1514
</code></pre></div> <h1 id=getting-creative>Getting Creative<a class=headerlink href=#getting-creative title="Permanent link"></a></h1> <ul> <li>Expressions are very nice, but the real magic of tcpdump comes from the ability to combine them in creative ways in order to isolate exactly what you’re looking for. </li> </ul> <h2 id=there-are-three-ways-to-do-combination>There are three ways to do combination:<a class=headerlink href=#there-are-three-ways-to-do-combination title="Permanent link"></a></h2> <h3 id=and>AND<a class=headerlink href=#and title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>and or &amp;&amp;
</code></pre></div> <h3 id=or>OR<a class=headerlink href=#or title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>or or ||
</code></pre></div> <h3 id=except>EXCEPT<a class=headerlink href=#except title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>not or !
</code></pre></div> <h1 id=usage-example>Usage Example:<a class=headerlink href=#usage-example title="Permanent link"></a></h1> <h3 id=traffic-thats-from-19216811-and-destined-for-ports-3389-or-22>Traffic that’s from 192.168.1.1 AND destined for ports 3389 or 22<a class=headerlink href=#traffic-thats-from-19216811-and-destined-for-ports-3389-or-22 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;src 192.168.1.1 and (dst port 3389 or 22)&#39;
</code></pre></div> <h1 id=advanced>Advanced<a class=headerlink href=#advanced title="Permanent link"></a></h1> <h3 id=show-me-all-urg-packets>Show me all URG packets:<a class=headerlink href=#show-me-all-urg-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 32 != 0&#39;
</code></pre></div> <h3 id=show-me-all-ack-packets>Show me all ACK packets:<a class=headerlink href=#show-me-all-ack-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 16 != 0&#39;
</code></pre></div> <h3 id=show-me-all-psh-packets>Show me all PSH packets:<a class=headerlink href=#show-me-all-psh-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 8 != 0&#39;
</code></pre></div> <h3 id=show-me-all-rst-packets>Show me all RST packets:<a class=headerlink href=#show-me-all-rst-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 4 != 0&#39;
</code></pre></div> <h3 id=show-me-all-syn-packets>Show me all SYN packets:<a class=headerlink href=#show-me-all-syn-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 2 != 0&#39;
</code></pre></div> <h3 id=show-me-all-fin-packets>Show me all FIN packets:<a class=headerlink href=#show-me-all-fin-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 1 != 0&#39;
</code></pre></div> <h3 id=show-me-all-syn-ack-packets>Show me all SYN-ACK packets:<a class=headerlink href=#show-me-all-syn-ack-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] = 18&#39;
</code></pre></div> <h3 id=show-all-traffic-with-both-syn-and-rst-flags-set-that-should-never-happen>Show all traffic with both SYN and RST flags set: (that should never happen)<a class=headerlink href=#show-all-traffic-with-both-syn-and-rst-flags-set-that-should-never-happen title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] = 6&#39;
</code></pre></div> <h3 id=show-all-traffic-with-the-evil-bit-set>Show all traffic with the “evil bit” set:<a class=headerlink href=#show-all-traffic-with-the-evil-bit-set title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;ip[6] &amp; 128 != 0&#39;
</code></pre></div> <h3 id=display-all-ipv6-traffic>Display all IPv6 Traffic:<a class=headerlink href=#display-all-ipv6-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump ip6
</code></pre></div> <h3 id=print-captured-packets-in-ascii>Print Captured Packets in ASCII<a class=headerlink href=#print-captured-packets-in-ascii title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -A -i eth0
</code></pre></div> <h3 id=display-captured-packets-in-hex-and-ascii>Display Captured Packets in HEX and ASCII<a class=headerlink href=#display-captured-packets-in-hex-and-ascii title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -XX -i eth0
</code></pre></div> <h3 id=capture-and-save-packets-in-a-file>Capture and Save Packets in a File<a class=headerlink href=#capture-and-save-packets-in-a-file title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -w 0001.pcap -i eth0
</code></pre></div> <h3 id=read-captured-packets-file>Read Captured Packets File<a class=headerlink href=#read-captured-packets-file title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -r 0001.pcap
</code></pre></div> <h3 id=capture-ip-address-packets>Capture IP address Packets<a class=headerlink href=#capture-ip-address-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n -i eth0
</code></pre></div> <h3 id=capture-only-tcp-packets>Capture only TCP Packets.<a class=headerlink href=#capture-only-tcp-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 tcp
</code></pre></div> <h3 id=capture-packet-from-specific-port>Capture Packet from Specific Port<a class=headerlink href=#capture-packet-from-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 port 22
</code></pre></div> <h3 id=capture-packets-from-source-ip>Capture Packets from source IP<a class=headerlink href=#capture-packets-from-source-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 src 192.168.0.2
</code></pre></div> <h3 id=capture-packets-from-destination-ip>Capture Packets from destination IP<a class=headerlink href=#capture-packets-from-destination-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 dst 50.116.66.139
</code></pre></div> <h3 id=capture-any-packed-coming-from-xxxx>Capture any packed coming from x.x.x.x<a class=headerlink href=#capture-any-packed-coming-from-xxxx title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n src host x.x.x.x
</code></pre></div> <h3 id=capture-any-packet-coming-from-or-going-to-xxxx>Capture any packet coming from or going to x.x.x.x<a class=headerlink href=#capture-any-packet-coming-from-or-going-to-xxxx title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n host x.x.x.x
</code></pre></div> <h3 id=capture-any-packet-going-to-xxxx>Capture any packet going to x.x.x.x<a class=headerlink href=#capture-any-packet-going-to-xxxx title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n dst host x.x.x.x
</code></pre></div> <h3 id=capture-any-packed-coming-from-xxxx_1>Capture any packed coming from x.x.x.x<a class=headerlink href=#capture-any-packed-coming-from-xxxx_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n src host x.x.x.x
</code></pre></div> <h3 id=capture-any-packet-going-to-network-xxx024>Capture any packet going to network x.x.x.0/24<a class=headerlink href=#capture-any-packet-going-to-network-xxx024 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n dst net x.x.x.0/24
</code></pre></div> <h3 id=capture-any-packet-coming-from-network-xxx024>Capture any packet coming from network x.x.x.0/24<a class=headerlink href=#capture-any-packet-coming-from-network-xxx024 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n src net x.x.x.0/24
</code></pre></div> <h3 id=capture-any-packet-with-destination-port-x>Capture any packet with destination port x<a class=headerlink href=#capture-any-packet-with-destination-port-x title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n dst port x
</code></pre></div> <h3 id=capture-any-packet-coming-from-port-x>Capture any packet coming from port x<a class=headerlink href=#capture-any-packet-coming-from-port-x title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n src port x
</code></pre></div> <h3 id=capture-any-packets-from-or-to-port-range-x-to-y>Capture any packets from or to port range x to y<a class=headerlink href=#capture-any-packets-from-or-to-port-range-x-to-y title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n dst(or src) portrange x-y
</code></pre></div> <h3 id=capture-any-tcp-or-udp-port-range-x-to-y>Capture any tcp or udp port range x to y<a class=headerlink href=#capture-any-tcp-or-udp-port-range-x-to-y title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n tcp(or udp) dst(or src) portrange x-y
</code></pre></div> <h3 id=capture-any-packets-with-dst-ip-xxxx-and-port-y>Capture any packets with dst ip x.x.x.x and port y<a class=headerlink href=#capture-any-packets-with-dst-ip-xxxx-and-port-y title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n &quot;dst host x.x.x.x and dst port y&quot;
</code></pre></div> <h3 id=capture-any-packets-with-dst-ip-xxxx-and-dst-ports-x-z>Capture any packets with dst ip x.x.x.x and dst ports x, z<a class=headerlink href=#capture-any-packets-with-dst-ip-xxxx-and-dst-ports-x-z title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n &quot;dst host x.x.x.x and (dst port x or dst port z)&quot;
</code></pre></div> <h3 id=capture-icmp--arp>Capture ICMP , ARP<a class=headerlink href=#capture-icmp--arp title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v icmp(or arp)
</code></pre></div> <h3 id=capture-packets-on-interface-eth0-and-dump-to-captxt-file>Capture packets on interface eth0 and dump to cap.txt file<a class=headerlink href=#capture-packets-on-interface-eth0-and-dump-to-captxt-file title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 -w cap.txt
</code></pre></div> <h3 id=get-packet-contents-with-hex-output>Get Packet Contents with Hex Output<a class=headerlink href=#get-packet-contents-with-hex-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -c 1 -X icmp
</code></pre></div> <h3 id=show-traffic-related-to-a-specific-port>Show Traffic Related to a Specific Port<a class=headerlink href=#show-traffic-related-to-a-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump port 3389 
tcpdump src port 1025
</code></pre></div> <h3 id=show-traffic-of-one-protocol>Show Traffic of One Protocol<a class=headerlink href=#show-traffic-of-one-protocol title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump icmp
</code></pre></div> <h3 id=find-traffic-by-ip_1>Find Traffic by IP<a class=headerlink href=#find-traffic-by-ip_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump host 1.1.1.1
</code></pre></div> <h3 id=filtering-by-source-andor-destination_1>Filtering by Source and/or Destination<a class=headerlink href=#filtering-by-source-andor-destination_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump src 1.1.1.1 
tcpdump dst 1.0.0.1
</code></pre></div> <h3 id=finding-packets-by-network_1>Finding Packets by Network<a class=headerlink href=#finding-packets-by-network_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump net 1.2.3.0/24
</code></pre></div> <h3 id=get-packet-contents-with-hex-output_1>Get Packet Contents with Hex Output<a class=headerlink href=#get-packet-contents-with-hex-output_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -c 1 -X icmp
</code></pre></div> <h3 id=show-traffic-related-to-a-specific-port_1>Show Traffic Related to a Specific Port<a class=headerlink href=#show-traffic-related-to-a-specific-port_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump port 3389 
tcpdump src port 1025
</code></pre></div> <h3 id=show-traffic-of-one-protocol_1>Show Traffic of One Protocol<a class=headerlink href=#show-traffic-of-one-protocol_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump icmp
</code></pre></div> <h3 id=show-only-ip6-traffic>Show only IP6 Traffic<a class=headerlink href=#show-only-ip6-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump ip6
</code></pre></div> <h3 id=find-traffic-using-port-ranges>Find Traffic Using Port Ranges<a class=headerlink href=#find-traffic-using-port-ranges title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump portrange 21-23
</code></pre></div> <h3 id=find-traffic-based-on-packet-size>Find Traffic Based on Packet Size<a class=headerlink href=#find-traffic-based-on-packet-size title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code> tcpdump less 32 
 tcpdump greater 64 
 tcpdump &lt;= 128
 tcpdump =&gt; 128
</code></pre></div> <h3 id=reading--writing-captures-to-a-file-pcap>Reading / Writing Captures to a File (pcap)<a class=headerlink href=#reading--writing-captures-to-a-file-pcap title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump port 80 -w capture_file
tcpdump -r capture_file
</code></pre></div> <h1 id=its-all-about-the-combinations>It’s All About the Combinations<a class=headerlink href=#its-all-about-the-combinations title="Permanent link"></a></h1> <h3 id=raw-output-view>Raw Output View<a class=headerlink href=#raw-output-view title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -ttnnvvS
</code></pre></div> <h2 id=here-are-some-examples-of-combined-commands>Here are some examples of combined commands.<a class=headerlink href=#here-are-some-examples-of-combined-commands title="Permanent link"></a></h2> <h3 id=from-specific-ip-and-destined-for-a-specific-port>From specific IP and destined for a specific Port<a class=headerlink href=#from-specific-ip-and-destined-for-a-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nnvvS src 10.5.2.3 and dst port 3389
</code></pre></div> <h3 id=from-one-network-to-another>From One Network to Another<a class=headerlink href=#from-one-network-to-another title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nvX src net 192.168.0.0/16 and dst net 10.0.0.0/8 or 172.16.0.0/16
</code></pre></div> <h3 id=non-icmp-traffic-going-to-a-specific-ip>Non ICMP Traffic Going to a Specific IP<a class=headerlink href=#non-icmp-traffic-going-to-a-specific-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump dst 192.168.0.2 and src net and not icmp
</code></pre></div> <h3 id=traffic-from-a-host-that-isnt-on-a-specific-port>Traffic From a Host That Isn’t on a Specific Port<a class=headerlink href=#traffic-from-a-host-that-isnt-on-a-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vv src mars and not dst port 22
</code></pre></div> <h3 id=isolate-tcp-rst-flags>Isolate TCP RST flags.<a class=headerlink href=#isolate-tcp-rst-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 4!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-rst&#39;
</code></pre></div> <h3 id=isolate-tcp-syn-flags>Isolate TCP SYN flags.<a class=headerlink href=#isolate-tcp-syn-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 2!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-syn&#39;
</code></pre></div> <h3 id=isolate-packets-that-have-both-the-syn-and-ack-flags-set>Isolate packets that have both the SYN and ACK flags set.<a class=headerlink href=#isolate-packets-that-have-both-the-syn-and-ack-flags-set title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13]=18&#39;
</code></pre></div> <h3 id=isolate-tcp-urg-flags>Isolate TCP URG flags.<a class=headerlink href=#isolate-tcp-urg-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 32!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-urg&#39;
</code></pre></div> <h3 id=isolate-tcp-ack-flags>Isolate TCP ACK flags.<a class=headerlink href=#isolate-tcp-ack-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 16!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-ack&#39;
</code></pre></div> <h3 id=isolate-tcp-psh-flags>Isolate TCP PSH flags.<a class=headerlink href=#isolate-tcp-psh-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 8!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-psh&#39;
</code></pre></div> <h3 id=isolate-tcp-fin-flags>Isolate TCP FIN flags.<a class=headerlink href=#isolate-tcp-fin-flags title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] &amp; 1!=0&#39;
tcpdump &#39;tcp[tcpflags] == tcp-fin&#39;
</code></pre></div> <h1 id=commands-that-i-using-almost-daily>Commands that I using almost daily<a class=headerlink href=#commands-that-i-using-almost-daily title="Permanent link"></a></h1> <h3 id=both-syn-and-rst-set>Both SYN and RST Set<a class=headerlink href=#both-syn-and-rst-set title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[13] = 6&#39;
</code></pre></div> <h3 id=find-http-user-agents>Find HTTP User Agents<a class=headerlink href=#find-http-user-agents title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAls0 | grep &#39;User-Agent:&#39;
tcpdump -nn -A -s1500 -l | grep &quot;User-Agent:&quot;
</code></pre></div> <h3 id=by-using-egrep-and-multiple-matches-we-can-get-the-user-agent-and-the-host-or-any-other-header-from-the-request>By using egrep and multiple matches we can get the User Agent and the Host (or any other header) from the request.<a class=headerlink href=#by-using-egrep-and-multiple-matches-we-can-get-the-user-agent-and-the-host-or-any-other-header-from-the-request title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn -A -s1500 -l | egrep -i &#39;User-Agent:|Host:&#39;
</code></pre></div> <h3 id=capture-only-http-get-and-post-packets-only-packets-that-match-get>Capture only HTTP GET and POST packets only packets that match GET.<a class=headerlink href=#capture-only-http-get-and-post-packets-only-packets-that-match-get title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -s 0 -A -vv &#39;tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420&#39;
tcpdump -s 0 -A -vv &#39;tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354&#39;
</code></pre></div> <h3 id=extract-http-request-urls>Extract HTTP Request URL's<a class=headerlink href=#extract-http-request-urls title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -s 0 -v -n -l | egrep -i &quot;POST /|GET /|Host:&quot;
</code></pre></div> <h3 id=extract-http-passwords-in-post-requests>Extract HTTP Passwords in POST Requests<a class=headerlink href=#extract-http-passwords-in-post-requests title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -s 0 -A -n -l | egrep -i &quot;POST /|pwd=|passwd=|password=|Host:&quot;
</code></pre></div> <h3 id=capture-cookies-from-server-and-from-client>Capture Cookies from Server and from Client<a class=headerlink href=#capture-cookies-from-server-and-from-client title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn -A -s0 -l | egrep -i &#39;Set-Cookie|Host:|Cookie:&#39;
</code></pre></div> <h3 id=capture-all-icmp-packets>Capture all ICMP packets<a class=headerlink href=#capture-all-icmp-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n icmp
</code></pre></div> <h3 id=show-icmp-packets-that-are-not-echoreply-standard-ping>Show ICMP Packets that are not ECHO/REPLY (standard ping)<a class=headerlink href=#show-icmp-packets-that-are-not-echoreply-standard-ping title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;icmp[icmptype] != icmp-echo and icmp[icmptype] != icmp-echoreply&#39;
</code></pre></div> <h3 id=capture-smtp--pop3-email>Capture SMTP / POP3 Email<a class=headerlink href=#capture-smtp--pop3-email title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn -l port 25 | grep -i &#39;MAIL FROM\|RCPT TO&#39;
</code></pre></div> <h3 id=troubleshooting-ntp-query-and-response>Troubleshooting NTP Query and Response<a class=headerlink href=#troubleshooting-ntp-query-and-response title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump dst port 123
</code></pre></div> <h3 id=capture-ftp-credentials-and-commands>Capture FTP Credentials and Commands<a class=headerlink href=#capture-ftp-credentials-and-commands title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn -v port ftp or ftp-data
</code></pre></div> <h3 id=rotate-capture-files>Rotate Capture Files<a class=headerlink href=#rotate-capture-files title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump  -w /tmp/capture-%H.pcap -G 3600 -C 200
</code></pre></div> <h3 id=capture-ipv6-traffic>Capture IPv6 Traffic<a class=headerlink href=#capture-ipv6-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn ip6 proto 6
</code></pre></div> <h3 id=ipv6-with-udp-and-reading-from-a-previously-saved-capture-file>IPv6 with UDP and reading from a previously saved capture file.<a class=headerlink href=#ipv6-with-udp-and-reading-from-a-previously-saved-capture-file title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nr ipv6-test.pcap ip6 proto 17
</code></pre></div> <h3 id=detect-port-scan-in-network-traffic>Detect Port Scan in Network Traffic<a class=headerlink href=#detect-port-scan-in-network-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn
</code></pre></div> <h1 id=usage-example_1>USAGE EXAMPLE<a class=headerlink href=#usage-example_1 title="Permanent link"></a></h1> <h3 id=example-filter-showing-nmap-nse-script-testing>Example Filter Showing Nmap NSE Script Testing<a class=headerlink href=#example-filter-showing-nmap-nse-script-testing title="Permanent link"></a></h3> <ul> <li> <p>On Target: </p> <p>nmap -p 80 &ndash;script=http-enum.nse targetip</p> </li> <li> <p>On Server: </p> <p>tcpdump -nn port 80 | grep "GET /"</p> <div class=highlight><pre><span></span><code>   GET /w3perl/ HTTP/1.1
   GET /w-agora/ HTTP/1.1
   GET /way-board/ HTTP/1.1
   GET /web800fo/ HTTP/1.1
   GET /webaccess/ HTTP/1.1
   GET /webadmin/ HTTP/1.1
   GET /webAdmin/ HTTP/1.1
</code></pre></div> </li> </ul> <h3 id=capture-start-and-end-packets-of-every-non-local-host>Capture Start and End Packets of every non-local host<a class=headerlink href=#capture-start-and-end-packets-of-every-non-local-host title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[tcpflags] &amp; (tcp-syn|tcp-fin) != 0 and not src and dst net localnet&#39;
</code></pre></div> <h3 id=capture-dns-request-and-response>Capture DNS Request and Response<a class=headerlink href=#capture-dns-request-and-response title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i wlp58s0 -s0 port 53
</code></pre></div> <h3 id=capture-http-data-packets>Capture HTTP data packets<a class=headerlink href=#capture-http-data-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#39;
</code></pre></div> <h3 id=capture-with-tcpdump-and-view-in-wireshark>Capture with tcpdump and view in Wireshark<a class=headerlink href=#capture-with-tcpdump-and-view-in-wireshark title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>ssh wuseman@localhost &#39;tcpdump -s0 -c 1000 -nn -w - not port 22&#39; | wireshark -k -i -
</code></pre></div> <h3 id=top-hosts-by-packets>Top Hosts by Packets<a class=headerlink href=#top-hosts-by-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nnn -t -c 200 | cut -f 1,2,3,4 -d &#39;.&#39; | sort | uniq -c | sort -nr | head -n 20
</code></pre></div> <h3 id=capture-all-the-plaintext-passwords>Capture all the plaintext passwords<a class=headerlink href=#capture-all-the-plaintext-passwords title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump port http or port ftp or port smtp or port imap or port pop3 or port telnet -l -A | egrep -i -B5 &#39;pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|password=|pass:|user:|username:|password:|login:|pass |user &#39;

tcpdump port http or port ftp or port smtp or port imap or port pop3 or port telnet -lA | egrep -i -B5 &#39;pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd= |password=|pass:|user:|username:|password:|login:|pass |user &#39;
</code></pre></div> <h3 id=dhcp-example>DHCP Example<a class=headerlink href=#dhcp-example title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v -n port 67 or 68
</code></pre></div> <h3 id=cleartext-get-requests>Cleartext GET Requests<a class=headerlink href=#cleartext-get-requests title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAls0 | grep &#39;GET&#39;
</code></pre></div> <h3 id=find-http-host-headers>Find HTTP Host Headers<a class=headerlink href=#find-http-host-headers title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAls0 | grep &#39;Host:&#39;
</code></pre></div> <h3 id=find-http-cookies>Find HTTP Cookies<a class=headerlink href=#find-http-cookies title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAls0 | grep &#39;Set-Cookie|Host:|Cookie:&#39;
</code></pre></div> <h3 id=find-ssh-connections>Find SSH Connections<a class=headerlink href=#find-ssh-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;tcp[(tcp[12]&gt;&gt;2):4] = 0x5353482D&#39;
</code></pre></div> <h3 id=find-dns-traffic>Find DNS Traffic<a class=headerlink href=#find-dns-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAs0 port 53
</code></pre></div> <h3 id=find-ftp-traffic>Find FTP Traffic<a class=headerlink href=#find-ftp-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAs0 port ftp or ftp-data
</code></pre></div> <h3 id=find-ntp-traffic>Find NTP Traffic<a class=headerlink href=#find-ntp-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vvAs0 port 123
</code></pre></div> <h3 id=capture-smtp--pop3-email_1>Capture SMTP / POP3 Email<a class=headerlink href=#capture-smtp--pop3-email_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nn -l port 25 | grep -i &#39;MAIL FROM\|RCPT TO&#39;
</code></pre></div> <h3 id=line-buffered-mode>Line Buffered Mode<a class=headerlink href=#line-buffered-mode title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i eth0 -s0 -l port 80 | grep &#39;Server:&#39;
</code></pre></div> <h3 id=find-traffic-with-evil-bit>Find traffic with evil bit<a class=headerlink href=#find-traffic-with-evil-bit title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump &#39;ip[6] &amp; 128 != 0&#39;
</code></pre></div> <h3 id=filter-on-protocol-icmp-and-protocol-specific-fields-icmp-type>Filter on protocol (ICMP) and protocol-specific fields (ICMP type)<a class=headerlink href=#filter-on-protocol-icmp-and-protocol-specific-fields-icmp-type title="Permanent link"></a></h3> <p>tcpdump -n icmp and 'icmp[0] != 8 and icmp[0] != 0'</p> <h3 id=same-command-can-be-used-with-predefined-header-field-offset-icmptype-and-icmp-type-field-values-icmp-echo-and-icmp-echoreply>Same command can be used with predefined header field offset (icmptype) and ICMP type field values (icmp-echo and icmp-echoreply):<a class=headerlink href=#same-command-can-be-used-with-predefined-header-field-offset-icmptype-and-icmp-type-field-values-icmp-echo-and-icmp-echoreply title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n icmp and icmp[icmptype] != icmp-echo and icmp[icmptype] != icmp-echoreply
</code></pre></div> <h3 id=filter-on-tos-field>Filter on TOS field<a class=headerlink href=#filter-on-tos-field title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v -n ip and ip[1]!=0
</code></pre></div> <h3 id=filter-on-ttl-field>Filter on TTL field<a class=headerlink href=#filter-on-ttl-field title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v ip and &#39;ip[8]&lt;2&#39;
</code></pre></div> <h3 id=filter-on-tcp-flags-synack>Filter on TCP flags (SYN/ACK)<a class=headerlink href=#filter-on-tcp-flags-synack title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n tcp and port 80 and &#39;tcp[tcpflags] &amp; tcp-syn == tcp-syn&#39;
</code></pre></div> <h3 id=in-the-example-above-all-packets-with-tcp-syn-flag-set-are-captured-other-flags-ack-for-example-might-be-set-also-packets-which-have-only-tcp-syn-flags-set-can-be-captured>In the example above, all packets with TCP SYN flag set are captured. Other flags (ACK, for example) might be set also. Packets which have only TCP SYN flags set, can be captured<a class=headerlink href=#in-the-example-above-all-packets-with-tcp-syn-flag-set-are-captured-other-flags-ack-for-example-might-be-set-also-packets-which-have-only-tcp-syn-flags-set-can-be-captured title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump tcp and port 80 and &#39;tcp[tcpflags] == tcp-syn&#39;
</code></pre></div> <h3 id=catch-tcp-synack-packets-typically-responses-from-servers>Catch TCP SYN/ACK packets (typically, responses from servers):<a class=headerlink href=#catch-tcp-synack-packets-typically-responses-from-servers title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -n tcp and &#39;tcp[tcpflags] &amp; (tcp-syn|tcp-ack) == (tcp-syn|tcp-ack)&#39;
tcpdump -n tcp and &#39;tcp[tcpflags] &amp; tcp-syn == tcp-syn&#39; and &#39;tcp[tcpflags] &amp; tcp-ack == tcp-ack&#39;
</code></pre></div> <h3 id=catch-arp-packets>Catch ARP packets<a class=headerlink href=#catch-arp-packets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -vv -e -nn ether proto 0x0806
</code></pre></div> <h3 id=filter-on-ip-packet-length>Filter on IP packet length<a class=headerlink href=#filter-on-ip-packet-length title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -l icmp and &#39;(ip[2:2]&gt;50)&#39; -w - |tcpdump -r - -v ip and &#39;(ip[2:2]&lt;60)&#39;
</code></pre></div> <h3 id=remark-due-to-some-bug-in-tcpdump-the-following-command-doesnt-catch-packets-as-expected>Remark: due to some bug in tcpdump, the following command doesn't catch packets as expected:<a class=headerlink href=#remark-due-to-some-bug-in-tcpdump-the-following-command-doesnt-catch-packets-as-expected title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v -n icmp and &#39;(ip[2:2]&gt;50)&#39; and &#39;(ip[2:2]&lt;60)&#39;
</code></pre></div> <h3 id=filter-on-encapsulated-content-icmp-within-pppoe>Filter on encapsulated content (ICMP within PPPoE)<a class=headerlink href=#filter-on-encapsulated-content-icmp-within-pppoe title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -v -n icmp
</code></pre></div> <h3 id=queiter>Queiter<a class=headerlink href=#queiter title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -q -i eth0
tcpdump -t -i eth0
tcpdump -A -n -q -i eth0 &#39;port 80&#39;
tcpdump -A -n -q -t -i eth0 &#39;port 80&#39;
</code></pre></div> <h3 id=print-only-useful-packets-from-the-http-traffic>Print only useful packets from the HTTP traffic<a class=headerlink href=#print-only-useful-packets-from-the-http-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -A -s 0 -q -t -i eth0 &#39;port 80 and ( ((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12:2]&amp;0xf0)&gt;&gt;2)) != 0)&#39;
</code></pre></div> <h3 id=dump-sip-traffic>Dump SIP Traffic<a class=headerlink href=#dump-sip-traffic title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -nq -s 0 -A -vvv port 5060 and host 1.2.3.4
</code></pre></div> <h3 id=checking-packet-content>Checking packet content<a class=headerlink href=#checking-packet-content title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>tcpdump -i any -c10 -nn -A port 80
</code></pre></div> <h3 id=checking-packet-content_1>Checking packet content<a class=headerlink href=#checking-packet-content_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>sudo tcpdump -i any -c10 -nn -A port 80
</code></pre></div> <h1 id=references--awesome-wikis>References &amp; Awesome wikis<a class=headerlink href=#references--awesome-wikis title="Permanent link"></a></h1> <ul> <li> <p><a href=https://hackertarget.com/tcpdump-examples/ >https://hackertarget.com/tcpdump-examples/</a></p> </li> <li> <p><a href=https://wiki.geant.org/display/public/EK/TcpdumpExamples>https://wiki.geant.org/display/public/EK/TcpdumpExamples</a></p> </li> <li> <p><a href=http://edoceo.com/cli/tcpdump>http://edoceo.com/cli/tcpdump</a></p> </li> <li> <p><a href=https://www.thegeekstuff.com/2010/08/tcpdump-command-examples/ >https://www.thegeekstuff.com/2010/08/tcpdump-command-examples/</a></p> </li> <li> <p><a href=https://opensource.com/article/18/10/introduction-tcpdump>https://opensource.com/article/18/10/introduction-tcpdump</a></p> </li> <li> <p><a href=https://programming.vip/docs/tcpdump-and-some-default-ports-of-linux.html>https://programming.vip/docs/tcpdump-and-some-default-ports-of-linux.html</a></p> </li> <li> <p><a href=https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-1/ >https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-1/</a></p> </li> <li> <p><a href=https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-2/ >https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-2/</a></p> </li> <li> <p><a href=https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf>https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a></p> </li> <li> <p><a href=https://sectools.org/tool/tcpdump/ >https://sectools.org/tool/tcpdump/</a></p> </li> </ul> <h4 id=contact>CONTACT<a class=headerlink href=#contact title="Permanent link"></a></h4> <p>If you have problems, questions, ideas or suggestions please contact us by posting to <a href=mailto:wuseman@nr1.nu>&#119;&#117;&#115;&#101;&#109;&#97;&#110;&#64;&#110;&#114;&#49;&#46;&#110;&#117;</a></p> <h4 id=web-site>WEB SITE<a class=headerlink href=#web-site title="Permanent link"></a></h4> <p>Visit our homepage for the latest info and updated tools</p> <p><a href=https://nr1.nu>https://nr1.nu</a> &amp; <a class="magiclink magiclink-github magiclink-mention" href=https://github.com/wuseman/ title="GitHub User: wuseman">@wuseman</a></p> <h4 id=end>END!<a class=headerlink href=#end title="Permanent link"></a></h4></div> </div> </div> <footer class=col-md-12> <hr> <p>Copyright &copy; 2015 - 2022 <a href=https://github.com/wuseman target=_blank rel=noopener>wuseman</a> </p> <p>Documentation built with <a href=https://www.mkdocs.org/ >MkDocs</a>.</p> </footer> <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script> <script src=../../js/base.js defer></script> <script src=https://unpkg.com/mermaid@8.13.3/dist/mermaid.min.js defer></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js defer></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js defer></script> <script src=../../assets/pymdownx-extras/extra-loader-5bb526e4.js defer></script> <script src=../../search/main.js defer></script> <div class=modal id=mkdocs_search_modal tabindex=-1 role=dialog aria-labelledby=searchModalLabel aria-hidden=true> <div class="modal-dialog modal-lg"> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=searchModalLabel>Search</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <p>From here you can search these documents. Enter your search terms below.</p> <form> <div class=form-group> <input type=search class=form-control placeholder=Search... id=mkdocs-search-query title="Type search term here"> </div> </form> <div id=mkdocs-search-results data-no-results-text="No results found"></div> </div> <div class=modal-footer> </div> </div> </div> </div><div class=modal id=mkdocs_keyboard_modal tabindex=-1 role=dialog aria-labelledby=keyboardModalLabel aria-hidden=true> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=keyboardModalLabel>Keyboard Shortcuts</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <table class=table> <thead> <tr> <th style="width: 20%;">Keys</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td class="help shortcut"><kbd>?</kbd></td> <td>Open this help</td> </tr> <tr> <td class="next shortcut"><kbd>n</kbd></td> <td>Next page</td> </tr> <tr> <td class="prev shortcut"><kbd>p</kbd></td> <td>Previous page</td> </tr> <tr> <td class="search shortcut"><kbd>s</kbd></td> <td>Search</td> </tr> </tbody> </table> </div> <div class=modal-footer> </div> </div> </div> </div> </body> </html> 