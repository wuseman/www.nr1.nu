<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=wuseman><link href=https://www.nr1.nu/linux/netstat/ rel=canonical><link rel="shortcut icon" href=../../img/favicon.ico><title>netstat - Nr1 (wuseman's wiki)</title><link href=../../css/bootstrap-3.3.7.min.css rel=stylesheet><link href=../../css/font-awesome.min.css rel=stylesheet><link href=../../css/base.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css><link href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css rel=stylesheet><link href=../../assets/pymdownx-extras/extra-e384f43f0f.css rel=stylesheet><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script src=../../js/jquery-1.10.2.min.js defer></script><script src=../../js/bootstrap-3.3.7.min.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script></head> <body> <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary"> <div class=container> <a class=navbar-brand href=../..>Nr1 (wuseman's wiki)</a> <!-- Expander button --> <button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse> <span class=navbar-toggler-icon></span> </button> <!-- Expanded navigation --> <div id=navbar-collapse class="navbar-collapse collapse"> <!-- Main navigation --> <ul class="nav navbar-nav"> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Home <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../.. class=dropdown-item>About</a> </li> <li> <a href=../../contact/ class=dropdown-item>Contact</a> </li> <li> <a href=../../cv/ class=dropdown-item>CV</a> </li> <li> <a href=../../usage_notes/ class=dropdown-item>Help</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Android <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../android/ class=dropdown-item>info</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>adb</a> <ul class=dropdown-menu> <li> <a href=../../android/adb/readme/ class=dropdown-item>adb</a> </li> <li> <a href=../../android/adb/at/ class=dropdown-item>at-commands</a> </li> <li> <a href=../../android/adb/uusd_codes/ class=dropdown-item>uusd-codes</a> </li> </ul> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Cracking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../cracking/ class=dropdown-item>info</a> </li> <li> <a href=../../cracking/wloader/ class=dropdown-item>wloader</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Gentoo <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../gentoo/gentoo-tools/ class=dropdown-item>gentoo-cheatsheet</a> </li> <li> <a href=../../gentoo/gentoo-chroot/ class=dropdown-item>gentoo-chroot</a> </li> <li> <a href=../../gentoo/gentoo-vmware/ class=dropdown-item>gentoo-vmware</a> </li> <li> <a href=../../gentoo/wuseman-overlay/ class=dropdown-item>wuseman-overlay</a> </li> <li> <a href=../../gentoo/gentoo-update/ class=dropdown-item>gentoo-wupdate</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Hacking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../hacking/ class=dropdown-item>hacking</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bios</a> <ul class=dropdown-menu> <li> <a href=../../hacking/bios/ class=dropdown-item>bios</a> </li> <li> <a href=../../hacking/bios/hp_device_and_bios-hacking/ class=dropdown-item>hp bios</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bruteforce</a> <ul class=dropdown-menu> <li> <a href=../../hacking/bruteforce/ class=dropdown-item>bruteforce</a> </li> <li> <a href=../../hacking/bruteforce/EMAGNET/ class=dropdown-item>emagnet</a> </li> <li> <a href=../../hacking/bruteforce/wbruter/ class=dropdown-item>wbruter</a> </li> <li> <a href=../../hacking/bruteforce/wssh/ class=dropdown-item>wssh</a> </li> <li> <a href=../../hacking/bruteforce/swedish_wordlist.txt/ class=dropdown-item>swedish wordlist</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Cameras</a> <ul class=dropdown-menu> <li> <a href=../../hacking/cameras/ class=dropdown-item>cameras</a> </li> <li> <a href=../../hacking/cameras/biltemas_babycam/ class=dropdown-item>biltemas babycam</a> </li> <li> <a href=../../hacking/cameras/dlink-6100lh/ class=dropdown-item>dlink-6100lh</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Chromebook</a> <ul class=dropdown-menu> <li> <a href=../../hacking/chromebook/ class=dropdown-item>chromebook</a> </li> <li> <a href=../../hacking/chromebook/acer_chromebook_c720/ class=dropdown-item>acer c720</a> </li> <li> <a href=../../hacking/chromebook/acer_chromebook_c740/ class=dropdown-item>acer c740</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Radio</a> <ul class=dropdown-menu> <li> <a href=../../hacking/radio/ class=dropdown-item>radio</a> </li> <li> <a href=../../hacking/radio/boose_soundtouch/ class=dropdown-item>boose soundtouch</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Router</a> <ul class=dropdown-menu> <li> <a href=../../hacking/routers/ class=dropdown-item>router</a> </li> <li> <a href=../../hacking/routers/technicolor_dga4330ts/ class=dropdown-item>technicolor dga4330ts</a> </li> </ul> </li> </ul> </li> <li class="dropdown active"> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Linux <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../apt/ class=dropdown-item>apt</a> </li> <li> <a href=../awk/ class=dropdown-item>awk</a> </li> <li> <a href=../chroot/ class=dropdown-item>chroot</a> </li> <li> <a href=../cryptsetup/ class=dropdown-item>cryptsetup</a> </li> <li> <a href=../curl/ class=dropdown-item>curl</a> </li> <li> <a href=../dev_and_proc/ class=dropdown-item>dev and proc</a> </li> <li> <a href=../exiftool/ class=dropdown-item>exiftool</a> </li> <li> <a href=../find/ class=dropdown-item>find</a> </li> <li> <a href=../git/ class=dropdown-item>git</a> </li> <li> <a href=../gnupg/ class=dropdown-item>gnupg</a> </li> <li> <a href=../grep/ class=dropdown-item>grep</a> </li> <li> <a href=../kernel/ class=dropdown-item>kernel</a> </li> <li> <a href=../log/ class=dropdown-item>log</a> </li> <li> <a href=../matomo/ class=dropdown-item>matomo</a> </li> <li> <a href=../merge-tricks/ class=dropdown-item>merge tricks</a> </li> <li> <a href=../nmap/ class=dropdown-item>nmap</a> </li> <li> <a href=./ class="dropdown-item active">netstat</a> </li> <li> <a href=../perf/ class=dropdown-item>perf</a> </li> <li> <a href=../rename/ class=dropdown-item>rename</a> </li> <li> <a href=../rg/ class=dropdown-item>ripgrep</a> </li> <li> <a href=../sed/ class=dropdown-item>sed</a> </li> <li> <a href=../ssh-log/ class=dropdown-item>ssh-log</a> </li> <li> <a href=../syslog-ng/syslog-conf.ng/ class=dropdown-item>syslog-ng</a> </li> <li> <a href=../sys/ class=dropdown-item>sys</a> </li> <li> <a href=../sqlmap/ class=dropdown-item>sqlmap</a> </li> <li> <a href=../tcpdump/ class=dropdown-item>tcpdump</a> </li> <li> <a href=../whatismyip/ class=dropdown-item>whatismyip</a> </li> <li> <a href=../wireguard/ class=dropdown-item>wireguard</a> </li> <li> <a href=../vim/ class=dropdown-item>vim</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Misc <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../archive/useragents/user_agents.txt class=dropdown-item>UserAgents</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav ml-auto"> <li class=nav-item> <a href=# class=nav-link data-toggle=modal data-target=#mkdocs_search_modal> <i class="fa fa-search"></i> Search </a> </li> <li class=nav-item> <a rel=prev href=../nmap/ class=nav-link> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li class=nav-item> <a rel=next href=../perf/ class=nav-link> Next <i class="fa fa-arrow-right"></i> </a> </li> <li class=nav-item> <a href=https://github.com/www.nr1.nu/tree/master/docs/src/markdown/linux/netstat.md class=nav-link>Edit on www.nr1.nu</a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role=complementary> <div class=navbar-header> <button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#toc-collapse title="Table of Contents"> <span class="fa fa-angle-down"></span> </button> </div> <div id=toc-collapse class="navbar-collapse collapse card bg-secondary"> <ul class="nav flex-column"> <li class=nav-item data-level=1><a href=#netstat class=nav-link>netstat</a> <ul class="nav flex-column"> </ul> </li> </ul> </div> </div></div> <div class=col-md-9 role=main> <h1 id=netstat>netstat<a class=headerlink href=#netstat title="Permanent link"></a></h1> <h3 id=find-all-ip-connected-to-my-host-through-tcp-connection-and-count-it>Find all IP connected to my host through TCP connection and count it<a class=headerlink href=#find-all-ip-connected-to-my-host-through-tcp-connection-and-count-it title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span>grep <span class=s2>&quot;:80&quot;</span> <span class=p>|</span>awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> sed s/::ffff://g <span class=p>|</span> cut -d: -f1 <span class=p>|</span>sort <span class=p>|</span>uniq -c <span class=p>|</span>sort -n <span class=p>|</span> tail -1000 <span class=p>|</span> grep -v <span class=s2>&quot;0.0.0.0&quot;</span>
</code></pre></div> <h3 id=equivalent-to-ifconfig--a-in-hpux>Equivalent to ifconfig -a in HPUX<a class=headerlink href=#equivalent-to-ifconfig--a-in-hpux title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nr<span class=p>|</span>egrep -v <span class=s2>&quot;Routing|Interface|lo0&quot;</span><span class=p>|</span>awk <span class=s1>&#39;{print $5}&#39;</span><span class=p>|</span>sort -u<span class=p>|</span> <span class=k>while</span> <span class=nb>read</span> l<span class=p>;</span> <span class=k>do</span> ifconfig <span class=nv>$l</span> <span class=p>;</span> <span class=nb>echo</span> <span class=s2>&quot;        Station Addr: `lanscan -ia|grep &quot;</span><span class=nv>$l</span> <span class=s2>&quot;|cut -d &#39; &#39; -f 1`&quot;</span> <span class=p>;</span> <span class=k>done</span>
</code></pre></div> <h3 id=quick-network-status-of-machine>Quick network status of machine<a class=headerlink href=#quick-network-status-of-machine title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;NR&gt;2 {print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</code></pre></div> <h3 id=open-port-check>Open Port Check<a class=headerlink href=#open-port-check title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep color -i -E <span class=s1>&#39;listen|listening&#39;</span>
</code></pre></div> <h3 id=see-keepalive-counters-on-tcp-connections>See KeepAlive counters on tcp connections<a class=headerlink href=#see-keepalive-counters-on-tcp-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -town
</code></pre></div> <h3 id=show-number-of-connections-per-remote-ip>Show number of connections per remote IP<a class=headerlink href=#show-number-of-connections-per-remote-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=find-default-gateway>Find default gateway<a class=headerlink href=#find-default-gateway title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -rn <span class=p>|</span> awk <span class=s1>&#39;/UG/{print $2}&#39;</span>
</code></pre></div> <h3 id=show-apps-that-use-internet-connection-at-the-moment>Show apps that use internet connection at the moment.<a class=headerlink href=#show-apps-that-use-internet-connection-at-the-moment title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep -i establ <span class=p>|</span> awk -F/ <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> uniq <span class=p>|</span> sort
</code></pre></div> <h3 id=all-ip-connected-to--my-host>All IP connected to my host<a class=headerlink href=#all-ip-connected-to--my-host title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nut <span class=p>|</span> awk <span class=s1>&#39;$NF==&quot;ESTABLISHED&quot; {print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort -u
</code></pre></div> <h3 id=display-only-tcp>display only tcp<a class=headerlink href=#display-only-tcp title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -4tnape
</code></pre></div> <h3 id=check-open-ports-both-ipv4-and-ipv6>check open ports (both ipv4 and ipv6)<a class=headerlink href=#check-open-ports-both-ipv4-and-ipv6 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plnt
</code></pre></div> <h3 id=show-open-ports-on-computer>show open ports on computer<a class=headerlink href=#show-open-ports-on-computer title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep -i listen
</code></pre></div> <h3 id=sorted-list-of-established-destination-connections>Sorted list of established destination connections<a class=headerlink href=#sorted-list-of-established-destination-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat <span class=p>|</span> grep EST <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> sort
</code></pre></div> <h3 id=get-number-of-established-sessions-on-a-given-port>Get number of established sessions on a given port<a class=headerlink href=#get-number-of-established-sessions-on-a-given-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp <span class=p>|</span> grep :80 <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> wc -l
</code></pre></div> <h3 id=get-connections-from-a-ssh-tunnel>Get connections from a SSH tunnel<a class=headerlink href=#get-connections-from-a-ssh-tunnel title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -t -p extend <span class=p>|</span> grep USERNAME
</code></pre></div> <h3 id=check-if-tcp-port-25-is-open>Check if TCP port 25 is open<a class=headerlink href=#check-if-tcp-port-25-is-open title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lntp
</code></pre></div> <h3 id=lists-all-listening-ports-together-with-the-pid-of-the-associated-process>Lists all listening ports together with the PID of the associated process<a class=headerlink href=#lists-all-listening-ports-together-with-the-pid-of-the-associated-process title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tunlp
</code></pre></div> <h3 id=list-current-ssh-clients>list current ssh clients<a class=headerlink href=#list-current-ssh-clients title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -atn <span class=p>|</span> grep :22 <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/:22//&#39;</span>
</code></pre></div> <h3 id=checking-total-connections-to-each-ip-inserver>Checking total connections to each Ip inserver<a class=headerlink href=#checking-total-connections-to-each-ip-inserver title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -alpn <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span>awk -F: <span class=s1>&#39;{print $(NF-1)}&#39;</span> <span class=p>|</span>sort <span class=p>|</span> 
</code></pre></div> <h3 id=show-the-number-of-current-httpd-processes>Show the number of current httpd processes<a class=headerlink href=#show-the-number-of-current-httpd-processes title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -l -p tcp <span class=p>|</span> egrep -e <span class=s1>&#39;www.*[0-9]{3,4}\/(apache2|httpd)&#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print$7}&#39;</span>
</code></pre></div> <h3 id=network-interfaces>Network Interfaces<a class=headerlink href=#network-interfaces title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ie
</code></pre></div> <h3 id=sh>```sh<a class=headerlink href=#sh title="Permanent link"></a></h3> <p>netstat with group by (ip adress) <div class=highlight><pre><span></span><code>```sh      
netstat -ntu | awk &#39; $5 ~ /^[0-9]/ {print $5}&#39; | cut -d: -f1 | sort | uniq -c | sort -n
</code></pre></div></p> <h3 id=prints-tcp-and-udp-connections>Prints tcp and udp connections<a class=headerlink href=#prints-tcp-and-udp-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nlput
</code></pre></div> <h3 id=see-the-time_wait-and-established-nums-of-the-network>see the TIME_WAIT and ESTABLISHED nums of the network<a class=headerlink href=#see-the-time_wait-and-established-nums-of-the-network title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> awk <span class=s1>&#39;/^tcp/ {++B[$NF]} END {for(a in B) print a, B[a]}&#39;</span>
</code></pre></div> <h3 id=see-a-list-of-ports-running>See a list of ports running<a class=headerlink href=#see-a-list-of-ports-running title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep -i listen
</code></pre></div> <h3 id=informations-sur-les-connexions-reseau>Informations sur les connexions reseau<a class=headerlink href=#informations-sur-les-connexions-reseau title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -taupe
</code></pre></div> <h3 id=sh_1>```sh<a class=headerlink href=#sh_1 title="Permanent link"></a></h3> <p>netstat -luntp <div class=highlight><pre><span></span><code>```sh      
netstat -luntp
</code></pre></div></p> <h3 id=_1>&#1593;&#1585;&#1590; &#1575;&#1578;&#1589;&#1575;&#1604;&#1575;&#1578; &#1604;&#1576;&#1608;&#1585;&#1578; &#1605;&#1581;&#1583;&#1583;<a class=headerlink href=#_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antp <span class=p>|</span> grep <span class=m>22</span>
</code></pre></div> <h3 id=display-connections-histogram>Display connections histogram<a class=headerlink href=#display-connections-histogram title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;\&#39;&#39;{print $5}&#39;</span><span class=se>\&#39;</span><span class=s1>&#39; | awk -F: &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;{print $1}&#39;</span><span class=se>\&#39;</span><span class=s1>&#39; | sort | uniq -c | awk &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;{ printf(&quot;%s\t%s\t&quot;,$2,$1); for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot;}&#39;</span><span class=se>\&#39;</span><span class=err>&#39;</span>
</code></pre></div> <h3 id=show-apps-that-use-internet-connection-at-the-moment-multi-language>Show apps that use internet connection at the moment. (Multi-Language)<a class=headerlink href=#show-apps-that-use-internet-connection-at-the-moment-multi-language title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep -i stab <span class=p>|</span> awk -F/ <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</code></pre></div> <h3 id=show-all-programs-on-udp-and-tcp-ports-with-timer-information>Show all programs on UDP and TCP ports with timer information<a class=headerlink href=#show-all-programs-on-udp-and-tcp-ports-with-timer-information title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -putona
</code></pre></div> <h3 id=examine-processes-generating-traffic-on-your-website>Examine processes generating traffic on your website<a class=headerlink href=#examine-processes-generating-traffic-on-your-website title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -np <span class=p>|</span> grep -v ^unix
</code></pre></div> <h3 id=list-programs-with-open-ports-and-connections>List programs with open ports and connections<a class=headerlink href=#list-programs-with-open-ports-and-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntauple
</code></pre></div> <h3 id=list-the-number-and-type-of-active-network-connections>List the number and type of active network connections<a class=headerlink href=#list-the-number-and-type-of-active-network-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ant <span class=p>|</span> awk <span class=s1>&#39;{print $NF}&#39;</span> <span class=p>|</span> grep -v <span class=s1>&#39;[a-z]&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c
</code></pre></div> <h3 id=show-complete-url-in-sh>Show complete URL in ```sh<a class=headerlink href=#show-complete-url-in-sh title="Permanent link"></a></h3> <p>netstat output <div class=highlight><pre><span></span><code>```sh      
netstat -tup -W | column -t
</code></pre></div></p> <h3 id=list-listen-port-by-numbers>List Listen Port by numbers<a class=headerlink href=#list-listen-port-by-numbers title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tlpn <span class=p>|</span> sort -t: -k2 -n
</code></pre></div> <h3 id=sh_2>```sh<a class=headerlink href=#sh_2 title="Permanent link"></a></h3> <p>netstat with group by ip adress <div class=highlight><pre><span></span><code>```sh      
netstat -ntu | awk &#39; $5 ~ /^[0-9]/ {print $5}&#39; | cut -d: -f1 | sort | uniq -c | sort -n
</code></pre></div></p> <h3 id=show-apps-that-use-internet-connection-at-the-moment_1>Show apps that use internet connection at the moment.<a class=headerlink href=#show-apps-that-use-internet-connection-at-the-moment_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep -i establ <span class=p>|</span> awk -F/ <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -atn <span class=p>|</span> awk <span class=s1>&#39; /tcp/ {printf(&quot;%s\n&quot;,substr($4,index($4,&quot;:&quot;)+1,length($4) )) }&#39;</span> <span class=p>|</span> sed -e <span class=s2>&quot;s/://g&quot;</span> <span class=p>|</span> sort -rnu <span class=p>|</span> awk <span class=s1>&#39;{array [$1] = $1} END {i=32768; again=1; while (again == 1) {if (array[i] == i) {i=i+1} else {print i; again=0}}}&#39;</span>
</code></pre></div> <h3 id=show-in-a-web-server-running-in-the-port-80-how-many-established-connections-by-ip-it-has>Show in a web server, running in the port 80, how many ESTABLISHED connections by ip it has.<a class=headerlink href=#show-in-a-web-server-running-in-the-port-80-how-many-established-connections-by-ip-it-has title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ant <span class=p>|</span> grep :80 <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=sorted-list-of-established-destination-connections_1>Sorted list of established destination connections<a class=headerlink href=#sorted-list-of-established-destination-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat <span class=p>|</span> awk <span class=s1>&#39;/EST/{print $5}&#39;</span> <span class=p>|</span> sort
</code></pre></div> <h3 id=two-command-output>Two command output<a class=headerlink href=#two-command-output title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> grep ESTAB <span class=p>|</span>grep  :80  <span class=p>|</span> tee /dev/stderr <span class=p>|</span> wc -l
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an<span class=p>|</span>grep -ci <span class=s2>&quot;tcp.*established&quot;</span>
</code></pre></div> <h3 id=most-simple-way-to-get-a-list-of-open-ports>Most simple way to get a list of open ports<a class=headerlink href=#most-simple-way-to-get-a-list-of-open-ports title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnp
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine_1>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> awk <span class=s1>&#39;$1 ~ /[Tt][Cc][Pp]/ &amp;&amp; $NF ~ /ESTABLISHED/{i++}END{print &quot;Connected:\t&quot;, i}&#39;</span>
</code></pre></div> <h3 id=list-all-tcp-opened-ports-on-localhost-in-listen-mode>List all TCP opened ports on localhost in LISTEN mode<a class=headerlink href=#list-all-tcp-opened-ports-on-localhost-in-listen-mode title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nptl
</code></pre></div> <h3 id=list-top-20-ip-from-which-tcp-connection-is-in-syn_recv-state>List top 20 IP from which TCP connection is in SYN_RECV state<a class=headerlink href=#list-top-20-ip-from-which-tcp-connection-is-in-syn_recv-state title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -pant <span class=m>2</span>&gt; /dev/null <span class=p>|</span> grep SYN_ <span class=p>|</span> awk <span class=s1>&#39;{print $5;}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> tail -20
</code></pre></div> <h3 id=who-has-the-most-apache-connections>Who has the most Apache connections.<a class=headerlink href=#who-has-the-most-apache-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anl <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d <span class=s2>&quot;:&quot;</span> -f <span class=m>1</span> <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> grep -c IPHERE
</code></pre></div> <h3 id=netstat-connection-check>Netstat Connection Check<a class=headerlink href=#netstat-connection-check title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span>  cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> tail
</code></pre></div> <h3 id=show-complete-url-in-sh_1>Show complete URL in ```sh<a class=headerlink href=#show-complete-url-in-sh_1 title="Permanent link"></a></h3> <p>netstat output <div class=highlight><pre><span></span><code>```sh      
netstat -pnut -W | column -t -s $&#39;\t&#39;
</code></pre></div></p> <h3 id=show-what-pid-is-listening-on-port-80-on-linux>Show what PID is listening on port 80 on Linux<a class=headerlink href=#show-what-pid-is-listening-on-port-80-on-linux title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -alnp <span class=p>|</span> grep ::80
</code></pre></div> <h3 id=all-ip-connected-to--my-host_1>All IP connected to my host<a class=headerlink href=#all-ip-connected-to--my-host_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep ESTABLISHED <span class=p>|</span>awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort -u
</code></pre></div> <h3 id=get-a-process-list-by-listen-port>get a process list by listen port<a class=headerlink href=#get-a-process-list-by-listen-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntlp <span class=p>|</span> grep -w <span class=m>80</span> <span class=p>|</span> awk <span class=s1>&#39;{print $7}&#39;</span> <span class=p>|</span> cut -d/ -f1
</code></pre></div> <h3 id=ip-addresses-connected-to-port-80>IP addresses connected to port 80<a class=headerlink href=#ip-addresses-connected-to-port-80 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=m>2</span>&gt;/dev/null <span class=p>|</span> grep <span class=s1>&#39;:80 &#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span>sed -e <span class=s1>&#39;s/::ffff://&#39;</span> <span class=p>|</span> cut -f1 -d: <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn <span class=p>|</span> head
</code></pre></div> <h3 id=tcp-and-udp-listening-sockets>TCP and UDP listening sockets<a class=headerlink href=#tcp-and-udp-listening-sockets title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -t -u -l
</code></pre></div> <h3 id=the-program-listening-on-port-8080-through-ipv6>The program listening on port 8080 through IPv6<a class=headerlink href=#the-program-listening-on-port-8080-through-ipv6 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnp6 <span class=p>|</span> grep :8080 <span class=p>|</span> sed <span class=s1>&#39;s#^[^\/]*/\([a-z0-9]*\)#\1#&#39;</span>
</code></pre></div> <h3 id=list-ips-with-high-number-of-connections>list ips with high number of connections<a class=headerlink href=#list-ips-with-high-number-of-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=m>2</span>&gt;/dev/null <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -nr <span class=p>|</span> head
</code></pre></div> <h3 id=show-all-listening-and-open-server-connections-with-port-number-and-process-namepid>Show all LISTENing and open server connections, with port number and process name/pid<a class=headerlink href=#show-all-listening-and-open-server-connections-with-port-number-and-process-namepid title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tulpn
</code></pre></div> <h3 id=show-which-programs-are-listening-on-tcp-and-udp-ports>Show which programs are listening on TCP and UDP ports<a class=headerlink href=#show-which-programs-are-listening-on-tcp-and-udp-ports title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plunt
</code></pre></div> <h3 id=show-all-listening-and-established-ports-tcp-and-udp-together-with-the-pid-of-the-associated-process>Show all listening and established ports TCP and UDP together with the PID of the associated process<a class=headerlink href=#show-all-listening-and-established-ports-tcp-and-udp-together-with-the-pid-of-the-associated-process title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plantu
</code></pre></div> <h3 id=list-current-ssh-clients_1>list current ssh clients<a class=headerlink href=#list-current-ssh-clients_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;($4 ~ /:22\s*/) &amp;&amp; ($6 ~ /^EST/) {print substr($5, 0, index($5,&quot;:&quot;))}&#39;</span>
</code></pre></div> <h3 id=tell-if-a-port-is-in-use>tell if a port is in use<a class=headerlink href=#tell-if-a-port-is-in-use title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -a numeric-ports <span class=p>|</span> grep <span class=m>8321</span>
</code></pre></div> <h3 id=lists-all-listening-ports-together-with-the-pid-of-the-associated-process_1>Lists all listening ports together with the PID of the associated process<a class=headerlink href=#lists-all-listening-ports-together-with-the-pid-of-the-associated-process_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anpe
</code></pre></div> <h3 id=number-of-open-connections-per-ip>Number of open connections per ip.<a class=headerlink href=#number-of-open-connections-per-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_1>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat  -atn <span class=p>|</span> perl -0777 -ne <span class=s1>&#39;@ports = /tcp.*?\:(\d+)\s+/imsg ; for $port (32768..61000) {if(!grep(/^$port$/, @ports)) { print $port; last } }&#39;</span>
</code></pre></div> <h3 id=find-default-gateway_1>Find default gateway<a class=headerlink href=#find-default-gateway_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -rn <span class=p>|</span> grep UG <span class=p>|</span> tr -s <span class=s2>&quot; &quot;</span> <span class=p>|</span> cut -d<span class=s2>&quot; &quot;</span> -f2
</code></pre></div> <h3 id=fetch-the-gateway-ip-address>Fetch the Gateway Ip Address<a class=headerlink href=#fetch-the-gateway-ip-address title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nr <span class=p>|</span> awk <span class=s1>&#39;BEGIN {while ($3!=&quot;0.0.0.0&quot;) getline; print $2}&#39;</span>
</code></pre></div> <h3 id=sh_3>```sh<a class=headerlink href=#sh_3 title="Permanent link"></a></h3> <p>netstat with group by (ip adress) <div class=highlight><pre><span></span><code>```sh      
netstat -ntu | awk &#39; $5 ~ /^(::ffff:|[0-9|])/ { gsub(&quot;::ffff:&quot;,&quot;&quot;,$5); print $5}&#39; | cut -d: -f1 | sort | uniq -c | sort -nr
</code></pre></div></p> <h3 id=check-open-ports-both-ipv4-and-ipv6_1>check open ports (both ipv4 and ipv6)<a class=headerlink href=#check-open-ports-both-ipv4-and-ipv6_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plntu
</code></pre></div> <h3 id=to-find-which-host-made-maximum-number-of-specific-tcp-connections>To find which host made maximum number of specific tcp connections<a class=headerlink href=#to-find-which-host-made-maximum-number-of-specific-tcp-connections title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> grep <span class=s1>&#39;^tcp.*&lt;IP&gt;:&lt;PORT&gt;&#39;</span> <span class=p>|</span> tr <span class=s2>&quot; &quot;</span> <span class=p>|</span> awk <span class=s1>&#39;BEGIN{FS=&quot;( |:)&quot;}{print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n -k1 <span class=p>|</span> awk <span class=s1>&#39;{if ($1 &gt;= 10){print $2}}&#39;</span>
</code></pre></div> <h3 id=count-tcp-states-from-netstat>Count TCP States From Netstat<a class=headerlink href=#count-tcp-states-from-netstat title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> awk <span class=s1>&#39;/tcp/ {print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c
</code></pre></div> <h3 id=to-find-the-ldap-clients-connected-to-ldap-service-running-on-solaris>To find the LDAP clients connected to LDAP service running on Solaris<a class=headerlink href=#to-find-the-ldap-clients-connected-to-ldap-service-running-on-solaris title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n -f inet<span class=p>|</span>awk <span class=s1>&#39;/\.389/{print $2}&#39;</span><span class=p>|</span>cut -f1-4 -d.<span class=p>|</span>sort -u
</code></pre></div> <h3 id=summarize-the-number-of-open-tcp-connections-by-state>Summarize the number of open TCP connections by state<a class=headerlink href=#summarize-the-number-of-open-tcp-connections-by-state title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nt <span class=p>|</span> awk <span class=s1>&#39;{print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n -k <span class=m>1</span> -r
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine_2>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep -Ec <span class=s1>&#39;^tcp.+ESTABLISHED$&#39;</span>
</code></pre></div> <h3 id=count-ipv4-connections-per-ip>count IPv4 connections per IP<a class=headerlink href=#count-ipv4-connections-per-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp <span class=p>|</span>grep <span class=s1>&#39;tcp\|udp&#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> sed s/::ffff:// <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=tcp-and-udp-listening-sockets_1>TCP and UDP listening sockets<a class=headerlink href=#tcp-and-udp-listening-sockets_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tunlapo
</code></pre></div> <h3 id=active-internet-connections-only-servers>Active Internet connections (only servers)<a class=headerlink href=#active-internet-connections-only-servers title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnptu
</code></pre></div> <h3 id=open-listening-ports>open listening ports<a class=headerlink href=#open-listening-ports title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ltn <span class=p>|</span> awk -n <span class=s1>&#39;/tcp /{ split($4, x, &quot;:&quot;); print(x[2]); }&#39;</span> <span class=p>|</span> sort -n
</code></pre></div> <h3 id=list-state-of-nat>List state of NAT.<a class=headerlink href=#list-state-of-nat title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat-nat -n
</code></pre></div> <h3 id=check-for-listening-services>Check for listening services<a class=headerlink href=#check-for-listening-services title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tuapen <span class=p>|</span> grep LISTEN
</code></pre></div> <h3 id=sh_4>```sh<a class=headerlink href=#sh_4 title="Permanent link"></a></h3> <p>netstat with group by (ip adress) <div class=highlight><pre><span></span><code>```sh      
netstat -nt | awk -F&quot;:&quot; &#39;{print $2}&#39; | sort | uniq -c
</code></pre></div></p> <h3 id=graph--of-connections-for-each-hosts>Graph # of connections for each hosts.<a class=headerlink href=#graph--of-connections-for-each-hosts title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> awk <span class=s1>&#39;{ printf(&quot;%s\t%s\t&quot;,$2,$1) ; for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot; }&#39;</span>
</code></pre></div> <h3 id=graph--of-connections-for-each-hosts_1>Graph # of connections for each hosts.<a class=headerlink href=#graph--of-connections-for-each-hosts_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> awk <span class=s1>&#39;{ printf(&quot;%s\t%s\t&quot;,$2,$1) ; for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot; }&#39;</span>
</code></pre></div> <h3 id=find-out-if-mysql-is-up-and-listening-on-linux>Find out if MySQL is up and listening on Linux<a class=headerlink href=#find-out-if-mysql-is-up-and-listening-on-linux title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tap <span class=p>|</span> grep mysql
</code></pre></div> <h3 id=get-the-ip-connected-to-the-server-usefull-to-detect-ip-that-should-be-blocked>get the IP connected to the server (usefull to detect IP that should be blocked)<a class=headerlink href=#get-the-ip-connected-to-the-server-usefull-to-detect-ip-that-should-be-blocked title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort  <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=netstat-established>NETSTAT ESTABLISHED<a class=headerlink href=#netstat-established title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat <span class=p>|</span> find <span class=s2>&quot;ESTABLISHED&quot;</span>
</code></pre></div> <h3 id=monitor-all-open-connections-to-specific-port>monitor all open connections to specific port<a class=headerlink href=#monitor-all-open-connections-to-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp <span class=p>|</span> grep <span class=s2>&quot;:&lt;port&gt;&quot;</span>
</code></pre></div> <h3 id=check-if-tcp-port-25-is-open_1>Check if TCP port 25 is open<a class=headerlink href=#check-if-tcp-port-25-is-open_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tln <span class=p>|</span> grep :25
</code></pre></div> <h3 id=command-results-as-an-image-capture>Command results as an image capture<a class=headerlink href=#command-results-as-an-image-capture title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -rn <span class=p>|</span> convert label:@- netstat.png
</code></pre></div> <h3 id=list-open-tcpudp-ports>List open TCP/UDP ports<a class=headerlink href=#list-open-tcpudp-ports title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp tcp udp <span class=p>|</span> grep LISTEN
</code></pre></div> <h3 id=show-number-of-connections-per-remote-ip_1>Show number of connections per remote IP<a class=headerlink href=#show-number-of-connections-per-remote-ip_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antu <span class=p>|</span> awk <span class=s1>&#39;$5 ~ /[0-9]:/{split($5, a, &quot;:&quot;); ips[a[1]]++} END {for (ip in ips) print ips[ip], ip | &quot;sort -k1 -nr&quot;}&#39;</span>
</code></pre></div> <h3 id=list-open-tcpudp-ports_1>List open TCP/UDP ports<a class=headerlink href=#list-open-tcpudp-ports_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ltun
</code></pre></div> <h3 id=netstat-list-out-remote-ips-connected-to-server-only>Netstat List out Remote IP's Connected to Server Only<a class=headerlink href=#netstat-list-out-remote-ips-connected-to-server-only title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> egrep -v <span class=s1>&#39;(localhost|\*\:\*|Address|and|servers|fff|127\.0\.0)&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/:[0-99999999].*//g&#39;</span>
</code></pre></div> <h3 id=find-out-which-tcp-ports-are-listening-and-opened-by-which-process-in-verbose>find out which TCP ports are listening and opened by which process in verbose<a class=headerlink href=#find-out-which-tcp-ports-are-listening-and-opened-by-which-process-in-verbose title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tlvp
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_2>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tan <span class=p>|</span> awk <span class=s1>&#39;$1 == &quot;tcp&quot; &amp;&amp; $4 ~ /:/ { port=$4; sub(/^[^:]+:/, &quot;&quot;, port); used[int(port)] = 1; } END { for (p = 32768; p &lt;= 61000; ++p) if (! (p in used)) { print p; exit(0); }; exit(1); }&#39;</span>
</code></pre></div> <h3 id=showing-opened-ports-on-machine>showing opened ports on machine<a class=headerlink href=#showing-opened-ports-on-machine title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tulpnc
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_3>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -atn <span class=p>|</span> perl -ane <span class=s1>&#39;if ( $F[3] =~ /(\d+)$/ ) { $x{$1}=1 } END{ print( (grep {!$x{$_}} 32768..61000)[0] . &quot;\n&quot; )}&#39;</span>
</code></pre></div> <h3 id=lists-open-ports>Lists open ports<a class=headerlink href=#lists-open-ports title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antuwp <span class=p>|</span> egrep <span class=s2>&quot;(^[^t])|(^tcp.*LISTEN)&quot;</span>
</code></pre></div> <h3 id=number-of-connections-per-ip-with-range-24>Number of connections per IP with range 24<a class=headerlink href=#number-of-connections-per-ip-with-range-24 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span><span class=p>|</span> grep -v <span class=s1>&#39;:80&#39;</span> <span class=p>|</span> cut -f1 -d: <span class=p>|</span>cut -f1,2,3  -d. <span class=p>|</span> sort <span class=p>|</span> uniq -c<span class=p>|</span> sort -n
</code></pre></div> <h3 id=check-the-connection-of-the-maximum-number-of-ip>Check the connection of the maximum number of IP<a class=headerlink href=#check-the-connection-of-the-maximum-number-of-ip title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -na <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print$5}&#39;</span> <span class=p>|</span> awk -F : <span class=s1>&#39;{print$1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -r
</code></pre></div> <h3 id=detect-connections-on-port---android>Detect Connections On Port - Android<a class=headerlink href=#detect-connections-on-port---android title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lptu <span class=p>|</span> grep -E <span class=s2>&quot;22.*ESTABLISHED&quot;</span> <span class=p>|</span> cut -s -d <span class=s1>&#39;:&#39;</span> -f2 <span class=p>|</span> awk <span class=s1>&#39;{print $2}&#39;</span>
</code></pre></div> <h3 id=how-to-kill-process-that-is-running-on-certain-port-in-windows>How to Kill Process that is Running on Certain Port in Windows?<a class=headerlink href=#how-to-kill-process-that-is-running-on-certain-port-in-windows title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -a -o -n <span class=p>|</span> grep <span class=m>8080</span>
</code></pre></div> <h3 id=list-all-ips-connected-to-port-80>List all IP's connected to port 80<a class=headerlink href=#list-all-ips-connected-to-port-80 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=m>2</span>&gt;/dev/null <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -nr <span class=p>|</span> head
</code></pre></div> <h3 id=see-who-are-using-a-specific-port>See who are using a specific port<a class=headerlink href=#see-who-are-using-a-specific-port title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -Aan <span class=p>|</span> grep .80 <span class=p>|</span> grep -v <span class=m>127</span>.0.0.1 <span class=p>|</span> grep EST <span class=p>|</span> awk <span class=s1>&#39;{print $6}&#39;</span> <span class=p>|</span> cut -d <span class=s2>&quot;.&quot;</span> -f1,2,3,4 <span class=p>|</span> sort <span class=p>|</span> uniq
</code></pre></div> <h3 id=equivalent-to-ifconfig--a-in-hpux_1>Equivalent to ifconfig -a in HPUX<a class=headerlink href=#equivalent-to-ifconfig--a-in-hpux_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -in
</code></pre></div> <h3 id=print-whois-info-about-connected-ip-addresses>Print whois info about connected ip addresses<a class=headerlink href=#print-whois-info-about-connected-ip-addresses title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -np inet<span class=p>|</span>awk <span class=s1>&#39;/firefox/{split($5,a,&quot;:&quot;);z[a[1]]++} END{for(i in z){system(&quot;whois &quot; i)}}&#39;</span><span class=p>|</span>less
</code></pre></div> <h3 id=all-ip-connected-to--my-host_2>All IP connected to my host<a class=headerlink href=#all-ip-connected-to--my-host_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nut <span class=p>|</span> sed <span class=s1>&#39;/ESTABLISHED/!d;s/.*[\t ]\+\(.*\):.*/\1/&#39;</span> <span class=p>|</span> sort -u
</code></pre></div> <h3 id=number-of-open-connections-per-ip_1>Number of open connections per ip.<a class=headerlink href=#number-of-open-connections-per-ip_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep <span class=m>80</span> <span class=p>|</span> wc -l
</code></pre></div> <h3 id=quick-network-status-of-machine_1>Quick network status of machine<a class=headerlink href=#quick-network-status-of-machine_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;NR&gt;2 {print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</code></pre></div> <h3 id=see-keepalive-counters-on-tcp-connections_1>See KeepAlive counters on tcp connections<a class=headerlink href=#see-keepalive-counters-on-tcp-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -town
</code></pre></div> <h3 id=check-open-ports-both-ipv4-and-ipv6_2>check open ports (both ipv4 and ipv6)<a class=headerlink href=#check-open-ports-both-ipv4-and-ipv6_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plnt
</code></pre></div> <h3 id=see-the-time_wait-and-established-nums-of-the-network_1>see the TIME_WAIT and ESTABLISHED nums of the network<a class=headerlink href=#see-the-time_wait-and-established-nums-of-the-network_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> awk <span class=s1>&#39;/^tcp/ {++B[$NF]} END {for(a in B) print a, B[a]}&#39;</span>
</code></pre></div> <h3 id=display-connections-histogram_1>Display connections histogram<a class=headerlink href=#display-connections-histogram_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;\&#39;&#39;{print $5}&#39;</span><span class=se>\&#39;</span><span class=s1>&#39; | awk -F: &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;{print $1}&#39;</span><span class=se>\&#39;</span><span class=s1>&#39; | sort | uniq -c | awk &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;{ printf(&quot;%s\t%s\t&quot;,$2,$1); for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot;}&#39;</span><span class=se>\&#39;</span><span class=err>&#39;</span>
</code></pre></div> <h3 id=show-apps-that-use-internet-connection-at-the-moment-multi-language_1>Show apps that use internet connection at the moment. (Multi-Language)<a class=headerlink href=#show-apps-that-use-internet-connection-at-the-moment-multi-language_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep -i stab <span class=p>|</span> awk -F/ <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</code></pre></div> <h3 id=show-all-programs-on-udp-and-tcp-ports-with-timer-information_1>Show all programs on UDP and TCP ports with timer information<a class=headerlink href=#show-all-programs-on-udp-and-tcp-ports-with-timer-information_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -putona
</code></pre></div> <h3 id=examine-processes-generating-traffic-on-your-website_1>Examine processes generating traffic on your website<a class=headerlink href=#examine-processes-generating-traffic-on-your-website_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -np <span class=p>|</span> grep -v ^unix
</code></pre></div> <h3 id=list-programs-with-open-ports-and-connections_1>List programs with open ports and connections<a class=headerlink href=#list-programs-with-open-ports-and-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntauple
</code></pre></div> <h3 id=list-the-number-and-type-of-active-network-connections_1>List the number and type of active network connections<a class=headerlink href=#list-the-number-and-type-of-active-network-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ant <span class=p>|</span> awk <span class=s1>&#39;{print $NF}&#39;</span> <span class=p>|</span> grep -v <span class=s1>&#39;[a-z]&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c
</code></pre></div> <h3 id=show-complete-url-in-sh_2>Show complete URL in ```sh<a class=headerlink href=#show-complete-url-in-sh_2 title="Permanent link"></a></h3> <p>netstat output <div class=highlight><pre><span></span><code>```sh      
netstat -tup -W | column -t
</code></pre></div></p> <h3 id=list-listen-port-by-numbers_1>List Listen Port by numbers<a class=headerlink href=#list-listen-port-by-numbers_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tlpn <span class=p>|</span> sort -t: -k2 -n
</code></pre></div> <h3 id=sh_5>```sh<a class=headerlink href=#sh_5 title="Permanent link"></a></h3> <p>netstat with group by ip adress <div class=highlight><pre><span></span><code>```sh      
netstat -ntu | awk &#39; $5 ~ /^[0-9]/ {print $5}&#39; | cut -d: -f1 | sort | uniq -c | sort -n
</code></pre></div></p> <h3 id=show-apps-that-use-internet-connection-at-the-moment_2>Show apps that use internet connection at the moment.<a class=headerlink href=#show-apps-that-use-internet-connection-at-the-moment_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep -i establ <span class=p>|</span> awk -F/ <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_4>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_4 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -atn <span class=p>|</span> awk <span class=s1>&#39; /tcp/ {printf(&quot;%s\n&quot;,substr($4,index($4,&quot;:&quot;)+1,length($4) )) }&#39;</span> <span class=p>|</span> sed -e <span class=s2>&quot;s/://g&quot;</span> <span class=p>|</span> sort -rnu <span class=p>|</span> awk <span class=s1>&#39;{array [$1] = $1} END {i=32768; again=1; while (again == 1) {if (array[i] == i) {i=i+1} else {print i; again=0}}}&#39;</span>
</code></pre></div> <h3 id=show-in-a-web-server-running-in-the-port-80-how-many-established-connections-by-ip-it-has_1>Show in a web server, running in the port 80, how many ESTABLISHED connections by ip it has.<a class=headerlink href=#show-in-a-web-server-running-in-the-port-80-how-many-established-connections-by-ip-it-has_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ant <span class=p>|</span> grep :80 <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=sorted-list-of-established-destination-connections_2>Sorted list of established destination connections<a class=headerlink href=#sorted-list-of-established-destination-connections_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat <span class=p>|</span> awk <span class=s1>&#39;/EST/{print $5}&#39;</span> <span class=p>|</span> sort
</code></pre></div> <h3 id=two-command-output_1>Two command output<a class=headerlink href=#two-command-output_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> grep ESTAB <span class=p>|</span>grep  :80  <span class=p>|</span> tee /dev/stderr <span class=p>|</span> wc -l
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine_3>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an<span class=p>|</span>grep -ci <span class=s2>&quot;tcp.*established&quot;</span>
</code></pre></div> <h3 id=most-simple-way-to-get-a-list-of-open-ports_1>Most simple way to get a list of open ports<a class=headerlink href=#most-simple-way-to-get-a-list-of-open-ports_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnp
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine_4>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine_4 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> awk <span class=s1>&#39;$1 ~ /[Tt][Cc][Pp]/ &amp;&amp; $NF ~ /ESTABLISHED/{i++}END{print &quot;Connected:\t&quot;, i}&#39;</span>
</code></pre></div> <h3 id=list-all-tcp-opened-ports-on-localhost-in-listen-mode_1>List all TCP opened ports on localhost in LISTEN mode<a class=headerlink href=#list-all-tcp-opened-ports-on-localhost-in-listen-mode_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nptl
</code></pre></div> <h3 id=list-top-20-ip-from-which-tcp-connection-is-in-syn_recv-state_1>List top 20 IP from which TCP connection is in SYN_RECV state<a class=headerlink href=#list-top-20-ip-from-which-tcp-connection-is-in-syn_recv-state_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -pant <span class=m>2</span>&gt; /dev/null <span class=p>|</span> grep SYN_ <span class=p>|</span> awk <span class=s1>&#39;{print $5;}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> tail -20
</code></pre></div> <h3 id=who-has-the-most-apache-connections_1>Who has the most Apache connections.<a class=headerlink href=#who-has-the-most-apache-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anl <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d <span class=s2>&quot;:&quot;</span> -f <span class=m>1</span> <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> grep -c IPHERE
</code></pre></div> <h3 id=netstat-connection-check_1>Netstat Connection Check<a class=headerlink href=#netstat-connection-check_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span>  cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n <span class=p>|</span> tail
</code></pre></div> <h3 id=show-complete-url-in-sh_3>Show complete URL in ```sh<a class=headerlink href=#show-complete-url-in-sh_3 title="Permanent link"></a></h3> <p>netstat output <div class=highlight><pre><span></span><code>```sh      
netstat -pnut -W | column -t -s $&#39;\t&#39;
</code></pre></div></p> <h3 id=show-what-pid-is-listening-on-port-80-on-linux_1>Show what PID is listening on port 80 on Linux<a class=headerlink href=#show-what-pid-is-listening-on-port-80-on-linux_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -alnp <span class=p>|</span> grep ::80
</code></pre></div> <h3 id=all-ip-connected-to--my-host_3>All IP connected to my host<a class=headerlink href=#all-ip-connected-to--my-host_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lantp <span class=p>|</span> grep ESTABLISHED <span class=p>|</span>awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort -u
</code></pre></div> <h3 id=get-a-process-list-by-listen-port_1>get a process list by listen port<a class=headerlink href=#get-a-process-list-by-listen-port_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntlp <span class=p>|</span> grep -w <span class=m>80</span> <span class=p>|</span> awk <span class=s1>&#39;{print $7}&#39;</span> <span class=p>|</span> cut -d/ -f1
</code></pre></div> <h3 id=ip-addresses-connected-to-port-80_1>IP addresses connected to port 80<a class=headerlink href=#ip-addresses-connected-to-port-80_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=m>2</span>&gt;/dev/null <span class=p>|</span> grep <span class=s1>&#39;:80 &#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span>sed -e <span class=s1>&#39;s/::ffff://&#39;</span> <span class=p>|</span> cut -f1 -d: <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn <span class=p>|</span> head
</code></pre></div> <h3 id=tcp-and-udp-listening-sockets_2>TCP and UDP listening sockets<a class=headerlink href=#tcp-and-udp-listening-sockets_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -t -u -l
</code></pre></div> <h3 id=the-program-listening-on-port-8080-through-ipv6_1>The program listening on port 8080 through IPv6<a class=headerlink href=#the-program-listening-on-port-8080-through-ipv6_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnp6 <span class=p>|</span> grep :8080 <span class=p>|</span> sed <span class=s1>&#39;s#^[^\/]*/\([a-z0-9]*\)#\1#&#39;</span>
</code></pre></div> <h3 id=list-ips-with-high-number-of-connections_1>list ips with high number of connections<a class=headerlink href=#list-ips-with-high-number-of-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=m>2</span>&gt;/dev/null <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -nr <span class=p>|</span> head
</code></pre></div> <h3 id=show-all-listening-and-open-server-connections-with-port-number-and-process-namepid_1>Show all LISTENing and open server connections, with port number and process name/pid<a class=headerlink href=#show-all-listening-and-open-server-connections-with-port-number-and-process-namepid_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tulpn
</code></pre></div> <h3 id=show-which-programs-are-listening-on-tcp-and-udp-ports_1>Show which programs are listening on TCP and UDP ports<a class=headerlink href=#show-which-programs-are-listening-on-tcp-and-udp-ports_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plunt
</code></pre></div> <h3 id=show-all-listening-and-established-ports-tcp-and-udp-together-with-the-pid-of-the-associated-process_1>Show all listening and established ports TCP and UDP together with the PID of the associated process<a class=headerlink href=#show-all-listening-and-established-ports-tcp-and-udp-together-with-the-pid-of-the-associated-process_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plantu
</code></pre></div> <h3 id=list-current-ssh-clients_2>list current ssh clients<a class=headerlink href=#list-current-ssh-clients_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;($4 ~ /:22\s*/) &amp;&amp; ($6 ~ /^EST/) {print substr($5, 0, index($5,&quot;:&quot;))}&#39;</span>
</code></pre></div> <h3 id=tell-if-a-port-is-in-use_1>tell if a port is in use<a class=headerlink href=#tell-if-a-port-is-in-use_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -a numeric-ports <span class=p>|</span> grep <span class=m>8321</span>
</code></pre></div> <h3 id=lists-all-listening-ports-together-with-the-pid-of-the-associated-process_2>Lists all listening ports together with the PID of the associated process<a class=headerlink href=#lists-all-listening-ports-together-with-the-pid-of-the-associated-process_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anpe
</code></pre></div> <h3 id=number-of-open-connections-per-ip_2>Number of open connections per ip.<a class=headerlink href=#number-of-open-connections-per-ip_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_5>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_5 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat  -atn <span class=p>|</span> perl -0777 -ne <span class=s1>&#39;@ports = /tcp.*?\:(\d+)\s+/imsg ; for $port (32768..61000) {if(!grep(/^$port$/, @ports)) { print $port; last } }&#39;</span>
</code></pre></div> <h3 id=find-default-gateway_2>Find default gateway<a class=headerlink href=#find-default-gateway_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -rn <span class=p>|</span> grep UG <span class=p>|</span> tr -s <span class=s2>&quot; &quot;</span> <span class=p>|</span> cut -d<span class=s2>&quot; &quot;</span> -f2
</code></pre></div> <h3 id=fetch-the-gateway-ip-address_1>Fetch the Gateway Ip Address<a class=headerlink href=#fetch-the-gateway-ip-address_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nr <span class=p>|</span> awk <span class=s1>&#39;BEGIN {while ($3!=&quot;0.0.0.0&quot;) getline; print $2}&#39;</span>
</code></pre></div> <h3 id=sh_6>```sh<a class=headerlink href=#sh_6 title="Permanent link"></a></h3> <p>netstat with group by (ip adress) <div class=highlight><pre><span></span><code>```sh      
netstat -ntu | awk &#39; $5 ~ /^(::ffff:|[0-9|])/ { gsub(&quot;::ffff:&quot;,&quot;&quot;,$5); print $5}&#39; | cut -d: -f1 | sort | uniq -c | sort -nr
</code></pre></div></p> <h3 id=check-open-ports-both-ipv4-and-ipv6_3>check open ports (both ipv4 and ipv6)<a class=headerlink href=#check-open-ports-both-ipv4-and-ipv6_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -plntu
</code></pre></div> <h3 id=to-find-which-host-made-maximum-number-of-specific-tcp-connections_1>To find which host made maximum number of specific tcp connections<a class=headerlink href=#to-find-which-host-made-maximum-number-of-specific-tcp-connections_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n <span class=p>|</span> grep <span class=s1>&#39;^tcp.*&lt;IP&gt;:&lt;PORT&gt;&#39;</span> <span class=p>|</span> tr <span class=s2>&quot; &quot;</span> <span class=p>|</span> awk <span class=s1>&#39;BEGIN{FS=&quot;( |:)&quot;}{print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n -k1 <span class=p>|</span> awk <span class=s1>&#39;{if ($1 &gt;= 10){print $2}}&#39;</span>
</code></pre></div> <h3 id=count-tcp-states-from-netstat_1>Count TCP States From Netstat<a class=headerlink href=#count-tcp-states-from-netstat_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> awk <span class=s1>&#39;/tcp/ {print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c
</code></pre></div> <h3 id=to-find-the-ldap-clients-connected-to-ldap-service-running-on-solaris_1>To find the LDAP clients connected to LDAP service running on Solaris<a class=headerlink href=#to-find-the-ldap-clients-connected-to-ldap-service-running-on-solaris_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -n -f inet<span class=p>|</span>awk <span class=s1>&#39;/\.389/{print $2}&#39;</span><span class=p>|</span>cut -f1-4 -d.<span class=p>|</span>sort -u
</code></pre></div> <h3 id=summarize-the-number-of-open-tcp-connections-by-state_1>Summarize the number of open TCP connections by state<a class=headerlink href=#summarize-the-number-of-open-tcp-connections-by-state_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -nt <span class=p>|</span> awk <span class=s1>&#39;{print $6}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n -k <span class=m>1</span> -r
</code></pre></div> <h3 id=calulate-established-tcp-connection-of-local-machine_5>calulate established tcp connection of local machine<a class=headerlink href=#calulate-established-tcp-connection-of-local-machine_5 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep -Ec <span class=s1>&#39;^tcp.+ESTABLISHED$&#39;</span>
</code></pre></div> <h3 id=count-ipv4-connections-per-ip_1>count IPv4 connections per IP<a class=headerlink href=#count-ipv4-connections-per-ip_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp <span class=p>|</span>grep <span class=s1>&#39;tcp\|udp&#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> sed s/::ffff:// <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=tcp-and-udp-listening-sockets_3>TCP and UDP listening sockets<a class=headerlink href=#tcp-and-udp-listening-sockets_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tunlapo
</code></pre></div> <h3 id=active-internet-connections-only-servers_1>Active Internet connections (only servers)<a class=headerlink href=#active-internet-connections-only-servers_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -lnptu
</code></pre></div> <h3 id=open-listening-ports_1>open listening ports<a class=headerlink href=#open-listening-ports_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ltn <span class=p>|</span> awk -n <span class=s1>&#39;/tcp /{ split($4, x, &quot;:&quot;); print(x[2]); }&#39;</span> <span class=p>|</span> sort -n
</code></pre></div> <h3 id=list-state-of-nat_1>List state of NAT.<a class=headerlink href=#list-state-of-nat_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat-nat -n
</code></pre></div> <h3 id=check-for-listening-services_1>Check for listening services<a class=headerlink href=#check-for-listening-services_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tuapen <span class=p>|</span> grep LISTEN
</code></pre></div> <h3 id=sh_7>```sh<a class=headerlink href=#sh_7 title="Permanent link"></a></h3> <p>netstat with group by (ip adress) <div class=highlight><pre><span></span><code>```sh      
netstat -nt | awk -F&quot;:&quot; &#39;{print $2}&#39; | sort | uniq -c
</code></pre></div></p> <h3 id=graph--of-connections-for-each-hosts_2>Graph # of connections for each hosts.<a class=headerlink href=#graph--of-connections-for-each-hosts_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -an <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> awk -F: <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> awk <span class=s1>&#39;{ printf(&quot;%s\t%s\t&quot;,$2,$1) ; for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot; }&#39;</span>
</code></pre></div> <h3 id=find-out-if-mysql-is-up-and-listening-on-linux_1>Find out if MySQL is up and listening on Linux<a class=headerlink href=#find-out-if-mysql-is-up-and-listening-on-linux_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tap <span class=p>|</span> grep mysql
</code></pre></div> <h3 id=get-the-ip-connected-to-the-server-usefull-to-detect-ip-that-should-be-blocked_1>get the IP connected to the server (usefull to detect IP that should be blocked)<a class=headerlink href=#get-the-ip-connected-to-the-server-usefull-to-detect-ip-that-should-be-blocked_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ntu <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort  <span class=p>|</span> uniq -c <span class=p>|</span> sort -n
</code></pre></div> <h3 id=netstat-established_1>NETSTAT ESTABLISHED<a class=headerlink href=#netstat-established_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat <span class=p>|</span> find <span class=s2>&quot;ESTABLISHED&quot;</span>
</code></pre></div> <h3 id=monitor-all-open-connections-to-specific-port_1>monitor all open connections to specific port<a class=headerlink href=#monitor-all-open-connections-to-specific-port_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp <span class=p>|</span> grep <span class=s2>&quot;:&lt;port&gt;&quot;</span>
</code></pre></div> <h3 id=check-if-tcp-port-25-is-open_2>Check if TCP port 25 is open<a class=headerlink href=#check-if-tcp-port-25-is-open_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tln <span class=p>|</span> grep :25
</code></pre></div> <h3 id=command-results-as-an-image-capture_1>Command results as an image capture<a class=headerlink href=#command-results-as-an-image-capture_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -rn <span class=p>|</span> convert label:@- netstat.png
</code></pre></div> <h3 id=list-open-tcpudp-ports_2>List open TCP/UDP ports<a class=headerlink href=#list-open-tcpudp-ports_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -anp tcp udp <span class=p>|</span> grep LISTEN
</code></pre></div> <h3 id=show-number-of-connections-per-remote-ip_2>Show number of connections per remote IP<a class=headerlink href=#show-number-of-connections-per-remote-ip_2 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antu <span class=p>|</span> awk <span class=s1>&#39;$5 ~ /[0-9]:/{split($5, a, &quot;:&quot;); ips[a[1]]++} END {for (ip in ips) print ips[ip], ip | &quot;sort -k1 -nr&quot;}&#39;</span>
</code></pre></div> <h3 id=list-open-tcpudp-ports_3>List open TCP/UDP ports<a class=headerlink href=#list-open-tcpudp-ports_3 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -ltun
</code></pre></div> <h3 id=netstat-list-out-remote-ips-connected-to-server-only_1>Netstat List out Remote IP's Connected to Server Only<a class=headerlink href=#netstat-list-out-remote-ips-connected-to-server-only_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span> <span class=p>|</span> egrep -v <span class=s1>&#39;(localhost|\*\:\*|Address|and|servers|fff|127\.0\.0)&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/:[0-99999999].*//g&#39;</span>
</code></pre></div> <h3 id=find-out-which-tcp-ports-are-listening-and-opened-by-which-process-in-verbose_1>find out which TCP ports are listening and opened by which process in verbose<a class=headerlink href=#find-out-which-tcp-ports-are-listening-and-opened-by-which-process-in-verbose_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tlvp
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_6>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_6 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tan <span class=p>|</span> awk <span class=s1>&#39;$1 == &quot;tcp&quot; &amp;&amp; $4 ~ /:/ { port=$4; sub(/^[^:]+:/, &quot;&quot;, port); used[int(port)] = 1; } END { for (p = 32768; p &lt;= 61000; ++p) if (! (p in used)) { print p; exit(0); }; exit(1); }&#39;</span>
</code></pre></div> <h3 id=showing-opened-ports-on-machine_1>showing opened ports on machine<a class=headerlink href=#showing-opened-ports-on-machine_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tulpnc
</code></pre></div> <h3 id=find-an-unused-unprivileged-tcp-port_7>find an unused unprivileged TCP port<a class=headerlink href=#find-an-unused-unprivileged-tcp-port_7 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -atn <span class=p>|</span> perl -ane <span class=s1>&#39;if ( $F[3] =~ /(\d+)$/ ) { $x{$1}=1 } END{ print( (grep {!$x{$_}} 32768..61000)[0] . &quot;\n&quot; )}&#39;</span>
</code></pre></div> <h3 id=lists-open-ports_1>Lists open ports<a class=headerlink href=#lists-open-ports_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -antuwp <span class=p>|</span> egrep <span class=s2>&quot;(^[^t])|(^tcp.*LISTEN)&quot;</span>
</code></pre></div> <h3 id=number-of-connections-per-ip-with-range-24_1>Number of connections per IP with range 24<a class=headerlink href=#number-of-connections-per-ip-with-range-24_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -tn <span class=p>|</span> grep :80 <span class=p>|</span> awk <span class=s1>&#39;{print $5}&#39;</span><span class=p>|</span> grep -v <span class=s1>&#39;:80&#39;</span> <span class=p>|</span> cut -f1 -d: <span class=p>|</span>cut -f1,2,3  -d. <span class=p>|</span> sort <span class=p>|</span> uniq -c<span class=p>|</span> sort -n
</code></pre></div> <h3 id=check-the-connection-of-the-maximum-number-of-ip_1>Check the connection of the maximum number of IP<a class=headerlink href=#check-the-connection-of-the-maximum-number-of-ip_1 title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>netstat -na <span class=p>|</span> grep ESTABLISHED <span class=p>|</span> awk <span class=s1>&#39;{print$5}&#39;</span> <span class=p>|</span> awk -F : <span class=s1>&#39;{print$1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -r
</code></pre></div></div> </div> </div> <footer class=col-md-12> <hr> <p>Copyright &copy; 2015 - 2022 <a href=https://github.com/wuseman target=_blank rel=noopener>wuseman</a> </p> <p>Documentation built with <a href=https://www.mkdocs.org/ >MkDocs</a>.</p> </footer> <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script> <script src=../../js/base.js defer></script> <script src=https://unpkg.com/mermaid@8.13.3/dist/mermaid.min.js defer></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js defer></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js defer></script> <script src=../../assets/pymdownx-extras/extra-loader-5bb526e4.js defer></script> <script src=../../search/main.js defer></script> <div class=modal id=mkdocs_search_modal tabindex=-1 role=dialog aria-labelledby=searchModalLabel aria-hidden=true> <div class="modal-dialog modal-lg"> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=searchModalLabel>Search</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <p>From here you can search these documents. Enter your search terms below.</p> <form> <div class=form-group> <input type=search class=form-control placeholder=Search... id=mkdocs-search-query title="Type search term here"> </div> </form> <div id=mkdocs-search-results data-no-results-text="No results found"></div> </div> <div class=modal-footer> </div> </div> </div> </div><div class=modal id=mkdocs_keyboard_modal tabindex=-1 role=dialog aria-labelledby=keyboardModalLabel aria-hidden=true> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=keyboardModalLabel>Keyboard Shortcuts</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <table class=table> <thead> <tr> <th style="width: 20%;">Keys</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td class="help shortcut"><kbd>?</kbd></td> <td>Open this help</td> </tr> <tr> <td class="next shortcut"><kbd>n</kbd></td> <td>Next page</td> </tr> <tr> <td class="prev shortcut"><kbd>p</kbd></td> <td>Previous page</td> </tr> <tr> <td class="search shortcut"><kbd>s</kbd></td> <td>Search</td> </tr> </tbody> </table> </div> <div class=modal-footer> </div> </div> </div> </div> </body> </html> 