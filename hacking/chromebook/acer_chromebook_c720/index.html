<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=wuseman><link href=https://www.nr1.nu/hacking/chromebook/acer_chromebook_c720/ rel=canonical><link rel="shortcut icon" href=../../../img/favicon.ico><title>acer c720 - Nr1 (wuseman's wiki)</title><link href=../../../css/bootstrap-3.3.7.min.css rel=stylesheet><link href=../../../css/font-awesome.min.css rel=stylesheet><link href=../../../css/base.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css><link href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css rel=stylesheet><link href=../../../assets/pymdownx-extras/extra-e384f43f0f.css rel=stylesheet><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><script src=../../../js/jquery-1.10.2.min.js defer></script><script src=../../../js/bootstrap-3.3.7.min.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script></head> <body> <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary"> <div class=container> <a class=navbar-brand href=../../..>Nr1 (wuseman's wiki)</a> <!-- Expander button --> <button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse> <span class=navbar-toggler-icon></span> </button> <!-- Expanded navigation --> <div id=navbar-collapse class="navbar-collapse collapse"> <!-- Main navigation --> <ul class="nav navbar-nav"> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Home <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../.. class=dropdown-item>About</a> </li> <li> <a href=../../../contact/ class=dropdown-item>Contact</a> </li> <li> <a href=../../../cv/ class=dropdown-item>CV</a> </li> <li> <a href=../../../usage_notes/ class=dropdown-item>Help</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Android <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../android/ class=dropdown-item>info</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>adb</a> <ul class=dropdown-menu> <li> <a href=../../../android/adb/readme/ class=dropdown-item>adb</a> </li> <li> <a href=../../../android/adb/at/ class=dropdown-item>at-commands</a> </li> <li> <a href=../../../android/adb/uusd_codes/ class=dropdown-item>uusd-codes</a> </li> </ul> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Cracking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../cracking/ class=dropdown-item>info</a> </li> <li> <a href=../../../cracking/wloader/ class=dropdown-item>wloader</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Gentoo <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../gentoo/gentoo-tools/ class=dropdown-item>gentoo-cheatsheet</a> </li> <li> <a href=../../../gentoo/gentoo-chroot/ class=dropdown-item>gentoo-chroot</a> </li> <li> <a href=../../../gentoo/gentoo-vmware/ class=dropdown-item>gentoo-vmware</a> </li> <li> <a href=../../../gentoo/wuseman-overlay/ class=dropdown-item>wuseman-overlay</a> </li> <li> <a href=../../../gentoo/gentoo-update/ class=dropdown-item>gentoo-wupdate</a> </li> </ul> </li> <li class="dropdown active"> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Hacking <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../ class=dropdown-item>hacking</a> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bios</a> <ul class=dropdown-menu> <li> <a href=../../bios/ class=dropdown-item>bios</a> </li> <li> <a href=../../bios/hp_device_and_bios-hacking/ class=dropdown-item>hp bios</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Bruteforce</a> <ul class=dropdown-menu> <li> <a href=../../bruteforce/ class=dropdown-item>bruteforce</a> </li> <li> <a href=../../bruteforce/EMAGNET/ class=dropdown-item>emagnet</a> </li> <li> <a href=../../bruteforce/wbruter/ class=dropdown-item>wbruter</a> </li> <li> <a href=../../bruteforce/wssh/ class=dropdown-item>wssh</a> </li> <li> <a href=../../bruteforce/swedish_wordlist.txt/ class=dropdown-item>swedish wordlist</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Cameras</a> <ul class=dropdown-menu> <li> <a href=../../cameras/ class=dropdown-item>cameras</a> </li> <li> <a href=../../cameras/biltemas_babycam/ class=dropdown-item>biltemas babycam</a> </li> <li> <a href=../../cameras/dlink-6100lh/ class=dropdown-item>dlink-6100lh</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Chromebook</a> <ul class=dropdown-menu> <li> <a href=../ class=dropdown-item>chromebook</a> </li> <li> <a href=./ class="dropdown-item active">acer c720</a> </li> <li> <a href=../acer_chromebook_c740/ class=dropdown-item>acer c740</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Radio</a> <ul class=dropdown-menu> <li> <a href=../../radio/ class=dropdown-item>radio</a> </li> <li> <a href=../../radio/boose_soundtouch/ class=dropdown-item>boose soundtouch</a> </li> </ul> </li> <li class=dropdown-submenu> <a href=# class=dropdown-item>Router</a> <ul class=dropdown-menu> <li> <a href=../../routers/ class=dropdown-item>router</a> </li> <li> <a href=../../routers/technicolor_dga4330ts/ class=dropdown-item>technicolor dga4330ts</a> </li> </ul> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Linux <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../linux/apt/ class=dropdown-item>apt</a> </li> <li> <a href=../../../linux/awk/ class=dropdown-item>awk</a> </li> <li> <a href=../../../linux/chroot/ class=dropdown-item>chroot</a> </li> <li> <a href=../../../linux/cryptsetup/ class=dropdown-item>cryptsetup</a> </li> <li> <a href=../../../linux/curl/ class=dropdown-item>curl</a> </li> <li> <a href=../../../linux/dev_and_proc/ class=dropdown-item>dev and proc</a> </li> <li> <a href=../../../linux/exiftool/ class=dropdown-item>exiftool</a> </li> <li> <a href=../../../linux/find/ class=dropdown-item>find</a> </li> <li> <a href=../../../linux/git/ class=dropdown-item>git</a> </li> <li> <a href=../../../linux/gnupg/ class=dropdown-item>gnupg</a> </li> <li> <a href=../../../linux/grep/ class=dropdown-item>grep</a> </li> <li> <a href=../../../linux/kernel/ class=dropdown-item>kernel</a> </li> <li> <a href=../../../linux/log/ class=dropdown-item>log</a> </li> <li> <a href=../../../linux/matomo/ class=dropdown-item>matomo</a> </li> <li> <a href=../../../linux/merge-tricks/ class=dropdown-item>merge tricks</a> </li> <li> <a href=../../../linux/nmap/ class=dropdown-item>nmap</a> </li> <li> <a href=../../../linux/netstat/ class=dropdown-item>netstat</a> </li> <li> <a href=../../../linux/perf/ class=dropdown-item>perf</a> </li> <li> <a href=../../../linux/rename/ class=dropdown-item>rename</a> </li> <li> <a href=../../../linux/rg/ class=dropdown-item>ripgrep</a> </li> <li> <a href=../../../linux/sed/ class=dropdown-item>sed</a> </li> <li> <a href=../../../linux/ssh-log/ class=dropdown-item>ssh-log</a> </li> <li> <a href=../../../linux/syslog-ng/syslog-conf.ng/ class=dropdown-item>syslog-ng</a> </li> <li> <a href=../../../linux/sys/ class=dropdown-item>sys</a> </li> <li> <a href=../../../linux/sqlmap/ class=dropdown-item>sqlmap</a> </li> <li> <a href=../../../linux/tcpdump/ class=dropdown-item>tcpdump</a> </li> <li> <a href=../../../linux/whatismyip/ class=dropdown-item>whatismyip</a> </li> <li> <a href=../../../linux/wireguard/ class=dropdown-item>wireguard</a> </li> <li> <a href=../../../linux/vim/ class=dropdown-item>vim</a> </li> </ul> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Misc <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../archive/useragents/user_agents.txt class=dropdown-item>UserAgents</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav ml-auto"> <li class=nav-item> <a href=# class=nav-link data-toggle=modal data-target=#mkdocs_search_modal> <i class="fa fa-search"></i> Search </a> </li> <li class=nav-item> <a rel=prev href=../ class=nav-link> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li class=nav-item> <a rel=next href=../acer_chromebook_c740/ class=nav-link> Next <i class="fa fa-arrow-right"></i> </a> </li> <li class=nav-item> <a href=https://github.com/www.nr1.nu/tree/master/docs/src/markdown/hacking/chromebook/acer_chromebook_c720/README.md class=nav-link>Edit on www.nr1.nu</a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role=complementary> <div class=navbar-header> <button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#toc-collapse title="Table of Contents"> <span class="fa fa-angle-down"></span> </button> </div> <div id=toc-collapse class="navbar-collapse collapse card bg-secondary"> <ul class="nav flex-column"> <li class=nav-item data-level=1><a href=#acer-c720 class=nav-link>Acer C720</a> <ul class="nav flex-column"> </ul> </li> <li class=nav-item data-level=1><a href=#write-a-clean-bios-to-the-chip class=nav-link>Write a clean bios to the chip:</a> <ul class="nav flex-column"> </ul> </li> </ul> </div> </div></div> <div class=col-md-9 role=main> <h1 id=acer-c720>Acer C720<a class=headerlink href=#acer-c720 title="Permanent link"></a></h1> <p>How to hack any Acer C7(4)20 Chromebook that has been locked remotely by admin and how easy it is to take control over a chromebook</p> <p><img alt=c720 src=https://user-images.githubusercontent.com/26827453/174461655-7e6872f6-2fa1-4cfa-a027-40bb8e1e20e0.jpg></p> <p>Whole process from the first time we start this device until device will enter enrollment and there is nothing we can do more then see the process happening and then its out of our control (if we are not the admin)</p> <p><img alt=1 src=https://user-images.githubusercontent.com/26827453/174461657-5f8cea41-07d7-436d-8fd1-ae54fa64b41f.jpg> <img alt=2 src=https://user-images.githubusercontent.com/26827453/174461659-afe20964-e264-48b8-84f5-b31832500eda.jpg> <img alt=3 src=https://user-images.githubusercontent.com/26827453/174461660-08ed4809-1f21-4f07-8445-e27acd2446da.jpg> <img alt=4 src=https://user-images.githubusercontent.com/26827453/174461661-fcf2018c-67bc-42d3-ab57-7730e485af7a.jpg> <img alt=5 src=https://user-images.githubusercontent.com/26827453/174461662-b9a6f5c1-6220-4669-96c7-101573a9f850.jpg> <img alt=6 src=https://user-images.githubusercontent.com/26827453/174461665-cb379918-9a6e-43b6-97e9-2194951983b9.jpg> <img alt=7 src=https://user-images.githubusercontent.com/26827453/174461666-ab14f741-3e95-4503-b9a3-1015ffc5edeb.jpg></p> <p>So, are we pwned? Of course not nothing is impossible!! Now let us hack this device</p> <ul> <li>First of all, you must unscrew all screws and then when you opened the bottom of the laptop you must now remove the write-protection screw. Also, remove the battery:</li> <li> <p><img alt=wp src=https://user-images.githubusercontent.com/26827453/174461667-ba02f146-f8a9-4ea5-8688-b4d8a3164b7d.jpg> <img alt=wp2 src=https://user-images.githubusercontent.com/26827453/174461668-998b04d4-6b11-40f2-a0f4-99fd21e2c0a7.jpg></p> </li> <li> <p>Now, with your bios/eeprom programmer you can read and overwrite the current bios. The b√≠os chip is the below one: </p> </li> </ul> <p><img alt=clip src=https://user-images.githubusercontent.com/26827453/174461669-2513ea3a-3778-495b-8a86-aebf9fa52126.jpg></p> <p>Once clip is conncted and your programmer found the clip, backup the current data on the chip:</p> <div class=highlight><pre><span></span><code>flashrom -p ch341a_spi -r acer_c720p-locked.bin
</code></pre></div> <h1 id=write-a-clean-bios-to-the-chip>Write a clean bios to the chip:<a class=headerlink href=#write-a-clean-bios-to-the-chip title="Permanent link"></a></h1> <div class=highlight><pre><span></span><code>flashrom -p ch341a_spi -w new_bios.bin
</code></pre></div> <h3 id=kernel-commandline>Kernel commandline:<a class=headerlink href=#kernel-commandline title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code>cros_secure console= loglevel=7 init=/sbin/init cros_secure root=PARTUUID=7154669e-fca8-7e42-a967-fb4d9fa17343/PARTNROFF=1 rootwait rw dm_verity.error_behavior=3 dm_verity.max_bios=-1 dm_verity.dev_wait=0 dm=&quot;1 vroot none ro 1,0 2539520 verity payload=ROOT_DEV hashtree=HASH_DEV hashstart=2539520 alg=sha1 root_hexdigest=9c99ef74f8143304bad67f5ca941b0c0ccda3b0f salt=e5c44164a1e83b080c2d60e769953ba0a6138c654da4e929a1500825363be829&quot; noinitrd vt.global_cursor_default=0 kern_guid=7154669e-fca8-7e42-a967-fb4d9fa17343 add_efi_memmap boot=local noresume noswap i915.modeset=1 tpm_tis.force=1 tpm_tis.interrupts=0 nmi_watchdog=panic,lapic iTCO_vendor_support.vendorsupport=3
</code></pre></div> <h3 id=modules>Modules<a class=headerlink href=#modules title="Permanent link"></a></h3> <p>Default modules for C720</p> <div class=highlight><pre><span></span><code>Module                  Size  Used by
cmac                   <span class=m>12903</span>  <span class=m>2</span>
rfcomm                 <span class=m>28294</span>  <span class=m>4</span>
i2c_dev                <span class=m>13075</span>  <span class=m>0</span>
uinput                 <span class=m>17359</span>  <span class=m>0</span>
memconsole             <span class=m>12517</span>  <span class=m>0</span>
ath3k                  <span class=m>16819</span>  <span class=m>0</span>
snd_hda_codec_realtek    <span class=m>36389</span>  <span class=m>1</span>
btusb                  <span class=m>38875</span>  <span class=m>0</span>
btrtl                  <span class=m>12493</span>  <span class=m>1</span> btusb
btbcm                  <span class=m>12876</span>  <span class=m>1</span> btusb
btintel                <span class=m>13157</span>  <span class=m>1</span> btusb
bluetooth             <span class=m>316837</span>  <span class=m>33</span> ath3k,btbcm,btrtl,btusb,rfcomm,btintel
zram                   <span class=m>17580</span>  <span class=m>1</span>
zsmalloc               <span class=m>13082</span>  <span class=m>1</span> zram
snd_hda_codec_hdmi     <span class=m>35766</span>  <span class=m>1</span>
uvcvideo               <span class=m>70677</span>  <span class=m>0</span>
videobuf2_vmalloc      <span class=m>12897</span>  <span class=m>1</span> uvcvideo
videobuf2_memops       <span class=m>12617</span>  <span class=m>1</span> videobuf2_vmalloc
videobuf2_core         <span class=m>31555</span>  <span class=m>1</span> uvcvideo
snd_hda_intel          <span class=m>39591</span>  <span class=m>5</span>
snd_hda_codec         <span class=m>138464</span>  <span class=m>3</span> snd_hda_codec_realtek,snd_hda_codec_hdmi,snd_hda_intel
snd_hwdep              <span class=m>13442</span>  <span class=m>1</span> snd_hda_codec
snd_pcm                <span class=m>76877</span>  <span class=m>3</span> snd_hda_codec_hdmi,snd_hda_codec,snd_hda_intel
snd_page_alloc         <span class=m>17260</span>  <span class=m>2</span> snd_pcm,snd_hda_intel
fuse                   <span class=m>70564</span>  <span class=m>2</span>
nf_conntrack_ipv6      <span class=m>13689</span>  <span class=m>2</span>
nf_defrag_ipv6         <span class=m>12884</span>  <span class=m>1</span> nf_conntrack_ipv6
ip6table_filter        <span class=m>12540</span>  <span class=m>1</span>
ip6_tables             <span class=m>21995</span>  <span class=m>1</span> ip6table_filter
snd_seq_midi           <span class=m>12848</span>  <span class=m>0</span>
snd_seq_midi_event     <span class=m>13511</span>  <span class=m>1</span> snd_seq_midi
snd_rawmidi            <span class=m>22993</span>  <span class=m>1</span> snd_seq_midi
snd_seq                <span class=m>53235</span>  <span class=m>2</span> snd_seq_midi_event,snd_seq_midi
snd_seq_device         <span class=m>13234</span>  <span class=m>3</span> snd_seq,snd_rawmidi,snd_seq_midi
snd_timer              <span class=m>27201</span>  <span class=m>2</span> snd_pcm,snd_seq
ath9k_btcoex          <span class=m>120187</span>  <span class=m>0</span>
ath9k_common_btcoex    <span class=m>12819</span>  <span class=m>1</span> ath9k_btcoex
ath9k_hw_btcoex       <span class=m>375415</span>  <span class=m>2</span> ath9k_btcoex,ath9k_common_btcoex
ath                    <span class=m>22041</span>  <span class=m>3</span> ath9k_btcoex,ath9k_hw_btcoex,ath9k_common_btcoex
mac80211              <span class=m>377318</span>  <span class=m>1</span> ath9k_btcoex
cfg80211              <span class=m>159864</span>  <span class=m>3</span> ath,ath9k_btcoex,mac80211
joydev                 <span class=m>17112</span>  <span class=m>0</span>
</code></pre></div> <h3 id=lspci>lspci<a class=headerlink href=#lspci title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code><span class=m>00</span>:00.0 Host bridge: Intel Corporation Haswell-ULT DRAM Controller <span class=o>(</span>rev 0b<span class=o>)</span>
<span class=m>00</span>:02.0 VGA compatible controller: Intel Corporation Haswell-ULT Integrated Graphics Controller <span class=o>(</span>rev 0b<span class=o>)</span>
<span class=m>00</span>:03.0 Audio device: Intel Corporation Haswell-ULT HD Audio Controller <span class=o>(</span>rev 0b<span class=o>)</span>
<span class=m>00</span>:14.0 USB controller: Intel Corporation <span class=m>8</span> Series USB xHCI HC <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:15.0 DMA controller: Intel Corporation <span class=m>8</span> Series Low Power Sub-System DMA <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:15.1 Serial bus controller <span class=o>[</span>0c80<span class=o>]</span>: Intel Corporation <span class=m>8</span> Series I2C Controller <span class=c1>#0 (rev 04)</span>
<span class=m>00</span>:15.2 Serial bus controller <span class=o>[</span>0c80<span class=o>]</span>: Intel Corporation <span class=m>8</span> Series I2C Controller <span class=c1>#1 (rev 04)</span>
<span class=m>00</span>:1b.0 Audio device: Intel Corporation <span class=m>8</span> Series HD Audio Controller <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:1c.0 PCI bridge: Intel Corporation <span class=m>8</span> Series PCI Express Root Port <span class=m>1</span> <span class=o>(</span>rev e4<span class=o>)</span>
<span class=m>00</span>:1f.0 ISA bridge: Intel Corporation <span class=m>8</span> Series LPC Controller <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:1f.2 SATA controller: Intel Corporation <span class=m>8</span> Series SATA Controller <span class=m>1</span> <span class=o>[</span>AHCI mode<span class=o>]</span> <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:1f.3 SMBus: Intel Corporation <span class=m>8</span> Series SMBus Controller <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>00</span>:1f.6 Signal processing controller: Intel Corporation <span class=m>8</span> Series Thermal <span class=o>(</span>rev <span class=m>04</span><span class=o>)</span>
<span class=m>01</span>:00.0 Network controller: Qualcomm Atheros AR9462 Wireless Network Adapter <span class=o>(</span>rev <span class=m>01</span><span class=o>)</span>
</code></pre></div> <h3 id=sshd>SSHD<a class=headerlink href=#sshd title="Permanent link"></a></h3> <p>sshd is already installed and running but you wont be able to ssh into the device from another device because iptables is active and is set to DROP everything as default:</p> <div class=highlight><pre><span></span><code>Chain INPUT <span class=o>(</span>policy DROP<span class=o>)</span>
target     prot opt <span class=nb>source</span>               destination         
ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     icmp --  anywhere             anywhere            
ACCEPT     udp  --  anywhere             <span class=m>224</span>.0.0.251          udp dpt:mdns
ACCEPT     udp  --  anywhere             <span class=m>239</span>.255.255.250      udp dpt:1900
NFQUEUE    udp  --  anywhere             anywhere             NFQUEUE num <span class=m>10000</span>
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh

Chain FORWARD <span class=o>(</span>policy DROP<span class=o>)</span>
target     prot opt <span class=nb>source</span>               destination         

Chain OUTPUT <span class=o>(</span>policy DROP<span class=o>)</span>
target     prot opt <span class=nb>source</span>               destination         
NFQUEUE    udp  --  anywhere             <span class=m>224</span>.0.0.251          udp dpt:mdns NFQUEUE num <span class=m>10001</span>
NFQUEUE    udp  --  anywhere             <span class=m>239</span>.255.255.250      udp dpt:1900 NFQUEUE num <span class=m>10001</span>
ACCEPT     all  --  anywhere             anywhere             state NEW,RELATED,ESTABLISHED
ACCEPT     all  --  anywhere             anywhere    
</code></pre></div> <p>Just allow port 22 or clear iptables:</p> <div class=highlight><pre><span></span><code><span class=nv>iPV4</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>grep . /proc/net/fib_trie<span class=k>)</span><span class=s2>&quot;</span>
<span class=nv>iPV6</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>grep  <span class=s1>&#39;.&#39;</span> /proc/net/if_inet6<span class=k>)</span><span class=s2>&quot;</span><span class=p>;</span> 

<span class=k>if</span> <span class=o>[[</span> -n <span class=s2>&quot;</span><span class=si>${</span><span class=nv>iPV4</span><span class=si>}</span><span class=s2>&quot;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> 
<span class=nb>printf</span> <span class=s2>&quot;%25s\n&quot;</span> <span class=p>|</span> tr <span class=s1>&#39; &#39;</span> <span class=s1>&#39;-&#39;</span>
<span class=nb>printf</span> <span class=s2>&quot;%s\n&quot;</span> <span class=s2>&quot;Removing all ipv4 rules&quot;</span>
iptables -P INPUT ACCEPT 
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -t nat -F <span class=p>&amp;</span>&gt; /dev/null
iptables -t mangle -F <span class=p>&amp;</span>&gt; /dev/null
iptables -F
iptables -X
<span class=nb>printf</span> <span class=s2>&quot;%s\n&quot;</span> <span class=s2>&quot;...Done&quot;</span>
<span class=k>fi</span>

<span class=k>if</span> <span class=o>[[</span> -n <span class=s2>&quot;</span><span class=si>${</span><span class=nv>iPV6</span><span class=si>}</span><span class=s2>&quot;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> 
<span class=nb>printf</span> <span class=s2>&quot;%25s\n&quot;</span> <span class=p>|</span> tr <span class=s1>&#39; &#39;</span> <span class=s1>&#39;-&#39;</span>
<span class=nb>printf</span> <span class=s2>&quot;%s\n&quot;</span> <span class=s2>&quot;Removing all ipv6 rules&quot;</span>
ip6tables -P INPUT ACCEPT
ip6tables -P FORWARD ACCEPT
ip6tables -P OUTPUT ACCEPT
ip6tables -t nat -F <span class=p>&amp;</span>&gt; /dev/null
ip6tables -t mangle -F <span class=p>&amp;</span>&gt; /dev/null
ip6tables -F
ip6tables -X
<span class=nb>printf</span> <span class=s2>&quot;%s\n&quot;</span> <span class=s2>&quot;...Done&quot;</span>
<span class=k>fi</span>
<span class=nb>printf</span> <span class=s2>&quot;%25s\n&quot;</span> <span class=p>|</span> tr <span class=s1>&#39; &#39;</span> <span class=s1>&#39;-&#39;</span>
</code></pre></div> <p>Try ssh again, root works fine.</p> <p>NOTICE: You must set a root password before you can ssh into the device</p> <h3 id=set-chromeos-devpassword>Set chromeos devpassword:<a class=headerlink href=#set-chromeos-devpassword title="Permanent link"></a></h3> <div class=highlight><pre><span></span><code><span class=nv>PASSWD_FILE</span><span class=o>=</span><span class=s1>&#39;/mnt/stateful_partition/etc/devmode.passwd&#39;</span>
<span class=nv>pass</span><span class=o>=</span><span class=k>$(</span>openssl passwd -1<span class=k>)</span>

mkdir -p <span class=s2>&quot;</span><span class=si>${</span><span class=nv>PASSWD_FILE</span><span class=p>%/*</span><span class=si>}</span><span class=s2>&quot;</span>
chmod <span class=m>600</span> <span class=s2>&quot;</span><span class=si>${</span><span class=nv>PASSWD_FILE</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=nb>echo</span> <span class=s2>&quot;chronos:</span><span class=si>${</span><span class=nv>pass</span><span class=si>}</span><span class=s2>&quot;</span> &gt; <span class=s2>&quot;</span><span class=si>${</span><span class=nv>PASSWD_FILE</span><span class=si>}</span><span class=s2></span>
</code></pre></div> <h3 id=vpd>VPD:<a class=headerlink href=#vpd title="Permanent link"></a></h3> <p>This is funny. The remote lock is locking devices via the serial number and as root we can list the currect info about device via vpd -l and we are also allowed to write new serial number without any hacking needed, the screw must be removed (see the top of post, WP-Screw)</p> <ul> <li>vpd -i RO_VPD -s serial_number=xxxxxxx</li> <li>hit enter</li> <li>verify that our new serial has been written:</li> <li>vpd -l</li> </ul> <p>Read more about VPD and how it works on url: <a href=https://chromium.googlesource.com/chromiumos/platform/vpd/ >https://chromium.googlesource.com/chromiumos/platform/vpd/</a></p> <p>Touche! :) </p></div> </div> </div> <footer class=col-md-12> <hr> <p>Copyright &copy; 2015 - 2022 <a href=https://github.com/wuseman target=_blank rel=noopener>wuseman</a> </p> <p>Documentation built with <a href=https://www.mkdocs.org/ >MkDocs</a>.</p> </footer> <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script> <script src=../../../js/base.js defer></script> <script src=https://unpkg.com/mermaid@8.13.3/dist/mermaid.min.js defer></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js defer></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js defer></script> <script src=../../../assets/pymdownx-extras/extra-loader-5bb526e4.js defer></script> <script src=../../../search/main.js defer></script> <div class=modal id=mkdocs_search_modal tabindex=-1 role=dialog aria-labelledby=searchModalLabel aria-hidden=true> <div class="modal-dialog modal-lg"> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=searchModalLabel>Search</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <p>From here you can search these documents. Enter your search terms below.</p> <form> <div class=form-group> <input type=search class=form-control placeholder=Search... id=mkdocs-search-query title="Type search term here"> </div> </form> <div id=mkdocs-search-results data-no-results-text="No results found"></div> </div> <div class=modal-footer> </div> </div> </div> </div><div class=modal id=mkdocs_keyboard_modal tabindex=-1 role=dialog aria-labelledby=keyboardModalLabel aria-hidden=true> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=keyboardModalLabel>Keyboard Shortcuts</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <table class=table> <thead> <tr> <th style="width: 20%;">Keys</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td class="help shortcut"><kbd>?</kbd></td> <td>Open this help</td> </tr> <tr> <td class="next shortcut"><kbd>n</kbd></td> <td>Next page</td> </tr> <tr> <td class="prev shortcut"><kbd>p</kbd></td> <td>Previous page</td> </tr> <tr> <td class="search shortcut"><kbd>s</kbd></td> <td>Search</td> </tr> </tbody> </table> </div> <div class=modal-footer> </div> </div> </div> </div> </body> </html> 